<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning</title>
<!--Generated on Tue Apr 23 13:49:44 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->

<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-article.css" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wei (Wayne) Chen 
<br class="ltx_break">J. Mike Walker ’66 Department of Mechanical Engineering
<br class="ltx_break">Texas A&amp;M University
<br class="ltx_break">College Station, TX 77843 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">w.chen@tamu.edu</span> 
<br class="ltx_break">&amp;Rachel Sun 
<br class="ltx_break">Department of Mechanical Engineering
<br class="ltx_break">Massachusetts Institute of Technology
<br class="ltx_break">Cambridge, MA 02139 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">rmsun@mit.edu</span> 
<br class="ltx_break">&amp;Doksoo Lee 
<br class="ltx_break">Department of Mechanical Engineering
<br class="ltx_break">Northwestern University
<br class="ltx_break">Evanston, IL 60208 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">dslee@northwestern.edu</span> 
<br class="ltx_break">&amp;Carlos M. Portela 
<br class="ltx_break">Department of Mechanical Engineering
<br class="ltx_break">Massachusetts Institute of Technology
<br class="ltx_break">Cambridge, MA 02139 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">cportela@mit.edu</span> 
<br class="ltx_break">&amp;Wei Chen 
<br class="ltx_break">Department of Mechanical Engineering
<br class="ltx_break">Northwestern University
<br class="ltx_break">Evanston, IL 60208 
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">weichen@northwestern.edu</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
    
<p class="ltx_p">Metamaterials with functional responses, such as wave-based responses or deformation-induced property variation under external stimuli, can exhibit varying properties or functionalities under different conditions. Herein, we aim at rapid inverse design of these metamaterials to meet target qualitative functional behaviors. This inverse problem is challenging due to its intractability and the existence of non-unique solutions. Past works mainly focus on deep-learning-based methods that are data-demanding, require time-consuming training and hyperparameter tuning, and are non-interpretable. To overcome these limitations, we propose the Random-forest-based Interpretable Generative Inverse Design (RIGID), a single-shot inverse design method to achieve the fast generation of metamaterial designs with on-demand functional behaviors. Unlike most existing methods, by exploiting the interpretability of the random forest, we eliminate the need to train an inverse model mapping responses to designs. Based on the likelihood of target satisfaction derived from the trained forward model, one can sample design solutions using Markov chain Monte Carlo methods. The RIGID method therefore functions as a generative model that captures the conditional distribution of satisfying solutions given a design target. We demonstrate the effectiveness and efficiency of RIGID on both acoustic and optical metamaterial design problems where only small datasets (less than 250 training samples) are available. Synthetic design problems are created to further illustrate and validate the mechanism of likelihood estimation in RIGID. This work offers a new perspective on solving on-demand inverse design problems, showcasing the potential for incorporating interpretable machine learning into generative design and eliminating its large data requirement.</p>
  
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Metamaterials with functional responses are engineered materials that exhibit varying properties or behaviors under different conditions. One example is metamaterials whose electromagnetic, acoustic, or elastic wave propagation behaviors change with wavelengths or frequencies <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">jiang2022flexible</span>]</cite>. Another example is metamaterials that exhibit changing properties or functionalities due to deformation in response to external stimuli like temperature <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">boley2019shape</span>]</cite> and magnetic fields <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ma2022deep</span>]</cite>.
Tailoring functional responses of these metamaterials is of interest to applications such as sound and vibration control, analog computing, medical imaging, sensing, communication, and soft robotics. In many use cases, rather than precisely controlling the complete functional responses, we only care about <span class="ltx_text ltx_font_italic">qualitative</span> behaviors under certain conditions. For example, acoustic metamaterials were usually designed to have bandgaps at specified frequencies to achieve functionalities like wave-guiding <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">casadei_piezoelectric_2012</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2020acoustic</span>]</cite>, focusing <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">kim2021poroelastic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">xie2018acoustic</span>]</cite>, and vibration mitigation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">matlack2016composite</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">krodel2015wide</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">bayat2018wave</span>]</cite>. However, it is unnecessary and computationally expensive to design for the whole dispersion relation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ronellenfitsch2019inverse</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">goh2020inverse</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2020designing</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2021realization</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2022see</span>]</cite>. Similarly, we may design optical metamaterials to qualitatively manipulate optical properties (e.g., high or low absorption/reflection/transmission) under certain wavelengths, without requiring the entire spectral response to match an exact target <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">vismara2019solar</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">cheng2021plasmonic</span>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">Identifying metamaterial designs from a given target forms an inverse design problem. Unlike many forward problems where one can obtain solutions (e.g., spectral responses or material properties under external stimuli) by modeling the physics or conducting experiments, inverse design problems are usually intractable. Traditionally, these problems are solved by iterative optimization (i.e., minimizing the difference between the actual quantity of interest and the target) <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ronellenfitsch2019inverse</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">goh2020inverse</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2021realization</span>]</cite>. This, however, requires repeatedly updating the design solution and solving forward problems. When the design target changes, one needs to rerun the entire optimization process. Thus, inverse design by iterative optimization becomes impractical if solving the forward problem (by simulations or experiments) is time-consuming or if the design target needs to change frequently. To accelerate the optimization approach, prior works replaced simulations or experiments with machine learning models <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">inampudi2018neural</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">zhelyeznyakov2021deep</span>]</cite>. However, the efficiency and quality of final solutions are highly dependent on both the machine learning model and the optimization algorithm. On the other hand, a single run of optimization usually only returns one final solution, although multiple designs might satisfy a given target (i.e., the <span class="ltx_text ltx_font_italic">non-uniqueness</span> of solutions). For example, multiple acoustic metamaterial designs may have bandgaps within the same target frequency range. This non-uniqueness nature of inverse design problems was also shown for optical metasurfaces <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2018training</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">ma2019probabilistic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">An2021MultifunctionalNetwork</span>]</cite>. The optimization approach eliminates the opportunity to explore diverse alternative solutions.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p">To avoid iterative optimization and enable fast on-demand inverse design, prior research attempted to realize single-shot (iteration-free) inverse design using machine learning. There are three mainstream models (their schematic diagrams are shown in <span class="ltx_text ltx_font_italic">Appendix, Fig. <a href="#A1.F7" title="Figure 7 ‣ Appendix A Related Works on Single-Shot Inverse Design ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a></span>). The most straightforward approach is to learn a <span class="ltx_text ltx_font_italic">direct inverse mapping</span> from the response to design variables. Neural networks are the most commonly used machine learning model for this purpose, due to their high flexibility in approximating arbitrary nonlinear input-output relationships <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">Malkiel2018PlasmonicLearning</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2020designing</span>]</cite>. Despite the simplicity of the direct inverse mapping, its underlying assumption of the response-design mapping being one-to-one does not hold in many cases due to the non-uniqueness of solutions, as mentioned earlier. Such non-uniqueness will cause conflicting training instances where the same input (response) is associated with distinct outputs (designs), which will destabilize the convergence during neural network training <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2018training</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lee2023data</span>]</cite>. To avoid this issue, past work proposed the <span class="ltx_text ltx_font_italic">Tandem Neural Network (T-NN)</span> that cascades an inverse-design network with a forward-modeling network <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2018training</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">an2019deep</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">kumar2020inverse</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">Yeung2021MultiplexedNetworks</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">bastek2022inverting</span>]</cite>. Its training is split into two steps: (1) pretraining the forward-modeling network to approximate the design-response mapping and (2) training the cascaded network by freezing the weights of the pretrained forward-modeling network. There is no loss function that forces designs at the intermediate layer to match data (which contains conflicting instances), hence the training convergence issue is avoided. Nonetheless, the original T-NNs still learn a one-to-one response-design mapping and cannot account for the non-uniqueness of design solutions. To fundamentally solve this problem, one needs to learn a one-to-many mapping. Bastek et al. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bastek2022inverting</span>]</cite> integrated stochastic sampling into the inverse-design network to allow the generation of multiple feasible solutions. A large body of recent works achieved the goal of learning one-to-many mapping by using <span class="ltx_text ltx_font_italic">conditional generative models</span>, typically conditional generative adversarial networks (cGANs) <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">jiang2019free</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">so2019designing</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wen2020robust</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">gurbuz2021generative</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">An2021MultifunctionalNetwork</span>]</cite>, conditional variational autoencoders (cVAEs) <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">ma2019probabilistic</span>]</cite>, and conditional diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">lew2023single</span>]</cite>. These models can generate multiple designs given a target response by learning the distribution of designs conditioned on the response. Different generative models have distinct ways of learning conditional distributions. In general, this is realized by training neural networks to transform responses and random noise (or latent variables) into designs, so that the trained network can generate a non-deterministic design solution from a given target response and randomly sampled noise, which is equivalent to sampling from a conditional distribution.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p">Although conditional generative models have demonstrated success in solving inverse design problems, they still have issues, such as high data demand, exhaustive hyperparameter tuning, slow training, and low interpretability, especially compared to traditional machine learning models like decision trees and random forests. On the other hand, Elzouka et al. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">elzouka2020interpretable</span>]</cite> proposed to use the decision tree as a more interpretable model to solve both the forward prediction and inverse design problem. After training a decision tree for forward prediction, one can identify explicit design rules (i.e., feasible regions in the design space) by tracing from target leaf nodes to the root node. This approach also captures the one-to-many mapping nature of inverse design problems since it gives feasible design variable ranges rather than a single solution. However, there remain some limitations. Firstly, for solutions identified by the design rules, the method does not differentiate their likelihood of target satisfaction. Yet in reality, solutions always have different likelihoods due to the uncertainty of model estimation. Secondly, the method has to train two models: a random forest was trained first to ensure model accuracy and robustness, and then a large decision tree was trained to emulate the performance of the random forest and provide design rules. This is due to the challenge of deriving explicit design rules from an ensemble model like the random forest. Finally, the method was demonstrated on a problem with more than <math id="S1.p4.m1" class="ltx_Math" alttext="10^{4}" display="inline"><msup><mn>10</mn><mn>4</mn></msup></math> training data, while the effectiveness on smaller datasets (i.e., data with orders of magnitude smaller sample sizes) was not studied.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="fig/overview.pdf" id="S1.F1.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Schematic diagram of the RIGID method. We first train a random forest on a design-response dataset to learn the forward design-response relation — predicting qualitative responses (e.g., bandgap existence at any given wave frequency) of designs. Then given a design target, we can infer the likelihood of any design satisfying the target by probing into the trained random forest. New designs with tailored responses can be generated by sampling the design space based on the likelihood estimation.</figcaption>
</figure>
<div id="S1.p5" class="ltx_para">
<p class="ltx_p">This work aims to address the aforementioned problems by proposing a method called <span class="ltx_text ltx_font_italic">Random-forest-based Interpretable Generative Inverse Design (RIGID)</span>.
Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows an overview of this method. Specifically, we first train a forward prediction random forest. Then given a design target, we can probe the trained random forest to infer the likelihood of any design satisfying the target. To generate new designs tailored to the target, we can sample from the design space according to the likelihood. Compared to the most widely studied neural-network-based methods, RIGID has a much lower cost in training and hyperparameter tuning, and works more robustly on small-size datasets (as random forests are less prone to overfitting). Similar to deep generative models, it can generate a desired number of solutions, allowing one to explore alternative solutions that might have desired properties or functionalities beyond the ones considered as the target. The explicit likelihood estimation also offers an interpretable characterization of a design’s target satisfaction probability and allows an exploitation-exploration trade-off when selecting generated designs. We validate the RIGID method on two metamaterial design examples — an acoustic metamaterial design example, where the target is to generate metamaterials with specific bandgaps, and an optical metasurface design example, where the target is to generate metasurfaces with high absorbance at specified wavelengths.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p class="ltx_p">Our contributions are three-fold. First, we propose a single-shot inverse design method that is fast, generative, interpretable, and small-data-compatible. Secondly, we demonstrate the effectiveness of the proposed method on acoustic and optical metamaterial design examples, and propose both qualitative and quantitative ways of assessing our method. Finally, we create two synthetic test cases for fast examination and validation of model performance. These test cases can be used for future benchmarking studies of related methods.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">The functional response of metamaterials can be modeled as <math id="S2.p1.m1" class="ltx_Math" alttext="y=f(\mathbf{x},s)" display="inline"><mrow><mi>y</mi><mo>=</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>, where <math id="S2.p1.m2" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> denotes metamaterial design variables (e.g., materials and geometry parameters), <math id="S2.p1.m3" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> is an <span class="ltx_text ltx_font_italic">auxiliary variable</span> representing the independent variable (or the “<math id="S2.p1.m4" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>-axis”) of the response (e.g., the frequency/wavelength or the external stimuli such as temperature), and <math id="S2.p1.m5" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> indicates the value of the response associated with our design target. In this paper, we assume <math id="S2.p1.m6" class="ltx_Math" alttext="y\in\{0,1\}" display="inline"><mrow><mi>y</mi><mo>∈</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></math> since we only focus on qualitative behaviors at specified frequencies (e.g., for an acoustic metamaterial or an optical metamaterial design, whether a bandgap exists or whether the energy absorbance is higher than a threshold within a range of frequencies). We leave the more challenging problem of tailoring quantitative behaviors as future work.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p">We use a random forest to approximate the function <math id="S2.p2.m1" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math>. A random forest is an ensemble learning method that combines the predictions of multiple decision trees to improve accuracy and reduce overfitting <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">breiman2001random</span>]</cite>. The trained random forest serves as a <span class="ltx_text ltx_font_italic">forward prediction</span> model that predicts the outcome <math id="S2.p2.m2" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> given design variables <math id="S2.p2.m3" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> and the auxiliary variable <math id="S2.p2.m4" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math>. Compared to the widely used neural networks, the random forest as a forward prediction model offers (1) significantly faster training, (2) less hyperparameters to tune, (3) less susceptible to overfitting on small data, and (4) interpretability (i.e., the decision-making of each tree in the random forest is transparent). More importantly, this interpretability also allows us to realize <span class="ltx_text ltx_font_italic">inverse design</span> without training a separate inverse model.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="fig/rigid.pdf" id="S2.F2.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The inverse design pipeline of the proposed RIGID method (using the inverse design of acoustic metamaterials as an example). Given design parameters <math id="S2.F2.m9" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> and the auxiliary variable <math id="S2.F2.m10" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> (e.g., wave frequency), a trained random forest predicts the probability of the qualitative response <math id="S2.F2.m11" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> (e.g., bandgap existence). Each tree in the random forest splits the joint space of <math id="S2.F2.m12" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> and <math id="S2.F2.m13" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> into regions, each associated with a specific prediction (shown on leaf nodes). The splitting criteria are encoded in tree nodes. “T” means meeting a criterion and “F” means not meeting it. RIGID first identifies leaf nodes that are relevant to the considered range of auxiliary variable <math id="S2.F2.m14" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> by checking splitting criteria related to <math id="S2.F2.m15" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> and pruning tree branches that are irrelevant (Step 1). If the considered range of <math id="S2.F2.m16" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> has multiple parts, we repeat this step for each part and take the intersection of relevant leaves (Step 2). Each relevant leaf node corresponds to a decision path indicating a region in the design space, as well as a predicted probability of target satisfaction, which is a score we assign to the corresponding design space region (Step 3). With multiple trees in a random forest, we can average the scores predicted by each tree and use the average score as our likelihood estimation (Step 4). We can then sample from the design space based on the likelihood distribution to generate new designs tailored to the target (Step 5).</figcaption>
</figure>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows how, by probing the trained random forest, one can estimate a likelihood distribution for target satisfaction of solutions over the entire design space and sample (generate) new designs based on this likelihood distribution. Since we target qualitative (binary) behaviors at specified <math id="S2.p3.m1" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> (e.g., a bandgap in 3-4 MHz frequency or high absorption at a wavelength of 400-500 nm), we first identify the leaf nodes (on each decision tree in the random forest) that are relevant to the <math id="S2.p3.m2" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> in the target (Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 1). We do this by tracing down each tree, checking only the nodes that use <math id="S2.p3.m3" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> as the splitting feature, and pruning the branches that are irrelevant to the <math id="S2.p3.m4" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> in the target. For example, as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, there are two tree nodes using <math id="S2.p3.m5" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> as the splitting feature, with splitting criteria at <math id="S2.p3.m6" class="ltx_Math" alttext="s\leq 5" display="inline"><mrow><mi>s</mi><mo>≤</mo><mn>5</mn></mrow></math> and <math id="S2.p3.m7" class="ltx_Math" alttext="s\leq 7" display="inline"><mrow><mi>s</mi><mo>≤</mo><mn>7</mn></mrow></math>. Given the target frequency range of <math id="S2.p3.m8" class="ltx_Math" alttext="3\leq s\leq 4" display="inline"><mrow><mn>3</mn><mo>≤</mo><mi>s</mi><mo>≤</mo><mn>4</mn></mrow></math>, we can remove the right branches of both nodes as these branches are only relevant to <math id="S2.p3.m9" class="ltx_Math" alttext="s&gt;5" display="inline"><mrow><mi>s</mi><mo>&gt;</mo><mn>5</mn></mrow></math> and <math id="S2.p3.m10" class="ltx_Math" alttext="s&gt;7" display="inline"><mrow><mi>s</mi><mo>&gt;</mo><mn>7</mn></mrow></math>, respectively, which conflicts with the target range of <math id="S2.p3.m11" class="ltx_Math" alttext="3\leq s\leq 4" display="inline"><mrow><mn>3</mn><mo>≤</mo><mi>s</mi><mo>≤</mo><mn>4</mn></mrow></math>. After pruning these branches, we end up with a set of leaves relevant to the target (highlighted in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 1). When we have a combined target (e.g., bandgaps in both 3-4 MHz and 6-7 MHz, as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), we need to get the intersection of all the sets of relevant leaves and use that as the final set of relevant leaves (highlighted in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 2). Note that a combined target includes cases where there are multiple nonadjacent target ranges (e.g., 3-4 MHz and 6-7 MHz) or when a target range is split by a tree node (e.g., a target range of 4-6 MHz can be split by the node “<math id="S2.p3.m12" class="ltx_Math" alttext="s\leq 5" display="inline"><mrow><mi>s</mi><mo>≤</mo><mn>5</mn></mrow></math>”, thus we need to consider it as the combination of two target ranges — 4-5 MHz and 5-6 MHz). A more detailed discussion of this step is in <span class="ltx_text ltx_font_italic">Appendix, Sec. <a href="#A2" title="Appendix B Explanation of Step 2 in RIGID ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a></span>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p class="ltx_p">The next step is to trace up the tree from the <math id="S2.p4.m1" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math> relevant leaves, obtained by Step 2, to the root node (Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 3). This will result in <math id="S2.p4.m2" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math> decision paths, along which are nodes indicating splitting criteria for design variables <math id="S2.p4.m3" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math>. Thus, each decision path represents a set of design variable ranges, or in other words, a region in the design space. We assign each region a score equal to the predicted probability at each corresponding leaf. This probability is learned from the training data and equals the proportion of positive data in a leaf. It indicates the tree’s belief in the probability of a design <math id="S2.p4.m4" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> satisfying the target <math id="S2.p4.m5" class="ltx_Math" alttext="\mathcal{T}" display="inline"><mi class="ltx_font_mathcaligraphic">𝒯</mi></math> if the design falls in the design space region corresponding to the leaf. Therefore, with a single decision tree <math id="S2.p4.m6" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>, we already have the map of likelihood <math id="S2.p4.m7" class="ltx_Math" alttext="\mathcal{L}_{m}(\mathbf{x}|\mathcal{T})=\mathbb{P}_{m}(\mathcal{T}|\mathbf{x})" display="inline"><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">ℒ</mi><mi>m</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐱</mi><mo fence="false">|</mo><mi class="ltx_font_mathcaligraphic">𝒯</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>ℙ</mi><mi>m</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi class="ltx_font_mathcaligraphic">𝒯</mi><mo fence="false">|</mo><mi>𝐱</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for target satisfaction: each of the <math id="S2.p4.m8" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math> regions has a uniformly distributed likelihood equal to the predicted probability at the corresponding leaf, and the rest of the design space has a likelihood of 0 (Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 3).</p>
</div>
<div id="S2.p5" class="ltx_para">
<p class="ltx_p">Since a single decision tree usually lacks accuracy, robustness, and a way to quantify estimation uncertainty, we still want to take advantage of the random forest as an ensemble model for inverse design. We use Steps 1-3 to derive the likelihood distribution for each of the <math id="S2.p5.m1" class="ltx_Math" alttext="M" display="inline"><mi>M</mi></math> trees in the random forest, and simply use the average of these <math id="S2.p5.m2" class="ltx_Math" alttext="M" display="inline"><mi>M</mi></math> likelihood distributions as the final likelihood for target satisfaction, <math id="S2.p5.m3" class="ltx_Math" alttext="\mathcal{L}(\mathbf{x}|\mathcal{T})=\sum_{m}^{M}\mathcal{L}_{m}(\mathbf{x}|%
\mathcal{T})/M" display="inline"><mrow><mrow><mi class="ltx_font_mathcaligraphic">ℒ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐱</mi><mo fence="false">|</mo><mi class="ltx_font_mathcaligraphic">𝒯</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msubsup><mo>∑</mo><mi>m</mi><mi>M</mi></msubsup><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">ℒ</mi><mi>m</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐱</mi><mo fence="false">|</mo><mi class="ltx_font_mathcaligraphic">𝒯</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>/</mo><mi>M</mi></mrow></mrow></mrow></math>, which is a more complex and smooth function (Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 4). If more trees believe a design <math id="S2.p5.m4" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> has a higher likelihood of satisfying the target, then the design will have a higher likelihood <math id="S2.p5.m5" class="ltx_Math" alttext="\mathcal{L}(\mathbf{x}|\mathcal{T})" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">ℒ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐱</mi><mo fence="false">|</mo><mi class="ltx_font_mathcaligraphic">𝒯</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>. Finally, to generate new designs, we can sample from <math id="S2.p5.m6" class="ltx_Math" alttext="\mathcal{L}(\mathbf{x}|\mathcal{T})" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">ℒ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐱</mi><mo fence="false">|</mo><mi class="ltx_font_mathcaligraphic">𝒯</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math> using Markov chain Monte Carlo (MCMC) methods such as Metropolis-Hastings <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">hastings1970monte</span>]</cite> (Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Methods ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Step 5).</p>
</div>
<div id="S2.p6" class="ltx_para">
<p class="ltx_p">Compared to prior works, RIGID provides the following unique benefits:</p>
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p class="ltx_p">It is effective on small data problems as the random forest is less susceptible to overfitting.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p class="ltx_p">The training is fast (in seconds of wall time) and does not require computationally-demanding hyperparameter tuning. Once the training is done, no further training or iterative optimization is required to generate designs for different targets.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p class="ltx_p">The model is interpretable as one can easily probe the trained model to understand its reasoning behind any decision-making.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S2.I1.i4.p1" class="ltx_para">
<p class="ltx_p">It estimates the explicit likelihood of target satisfaction for every possible solution in the design space. Given a design target of specific functional behavior, we can generate an unlimited number of solutions based on the likelihood, allowing us to explore alternative solutions that might have desired properties or functionalities beyond the ones considered as the target.</p>
</div>
</li>
<li id="S2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S2.I1.i5.p1" class="ltx_para">
<p class="ltx_p">When generating design solutions, one can use a single parameter — the sampling threshold — to easily tune the trade-off between exploitation (i.e., generated designs have higher chances of satisfying the target) and exploration (i.e., generated designs cover a broader area of the design space), as we will demonstrate in Results.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">We demonstrate our RIGID method on an acoustic metamaterial design problem, an optical metasurface design problem, and two synthetic design problems. Based on a recent review article by Lee et al. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">lee2023data</span>]</cite> and other related works (e.g., <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bastek2022inverting</span>]</cite>), existing single-shot inverse design methods were demonstrated on training data size ranging from <math id="S3.p1.m1" class="ltx_Math" alttext="10^{3}" display="inline"><msup><mn>10</mn><mn>3</mn></msup></math> to <math id="S3.p1.m2" class="ltx_Math" alttext="10^{6}" display="inline"><msup><mn>10</mn><mn>6</mn></msup></math> in scale. Here we show that our method can work with much smaller-scale datasets (less than 250 training samples).</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">For all the test problems, we used the same random forest hyperparameter settings and did not perform hyperparameter tuning. Specifically, each random forest contains 1,000 trees with a minimum of 2 samples required to split an internal node and a minimum of 1 sample required to be at a leaf node. Gini impurity <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">BreiFrieStonOlsh84</span>]</cite> was used as the splitting criterion at tree nodes.
The train-test split ratio was 4:1. Since the positive/negative training data can be highly imbalanced (e.g., the frequency ranges with bandgaps are much narrower than those without), we used the Synthetic Minority Over-sampling TEchnique (SMOTE) <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chawla2002smote</span>]</cite> to over-sample the positive class. For all the case studies, the random forest training took less than 10 seconds on an Intel Core i5-9300H CPU 2.4GHz and 8GB memory.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p class="ltx_p">After training, we generate new designs by sampling from the resulting likelihood distribution using Metropolis-Hastings. In practice, Metropolis-Hastings can generate identical samples, which provides no benefits for design purposes. Thus in this work, we reject the designs identical to previous ones during sampling.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p class="ltx_p">Here we consider acoustic metamaterials that can control elastic wave propagation at ultrasound (MHz) frequencies. Varying the microscale geometries of acoustic metamaterials changes the dynamic properties of a material, such as bandgaps <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bayat2018wave</span>]</cite> (i.e., forbidden frequency ranges of a material) and wave propagation direction <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">casadei_piezoelectric_2012</span>]</cite>.
These materials promise applications in waveguides <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">casadei_piezoelectric_2012</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2020acoustic</span>]</cite>, lenses <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">kim2021poroelastic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">xie2018acoustic</span>]</cite>, and vibration mitigation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">krodel2015wide</span>]</cite>.
We present the braced cubic design framework (Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>A-B) as a method to tune the size and location of bandgaps (Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>C).
In particular, spherical micro-inertia are added to the center and corner of a braced cubic unit cell with strut radius <math id="S3.SS1.p1.m1" class="ltx_Math" alttext="r_{\text{strut}}" display="inline"><msub><mi>r</mi><mtext>strut</mtext></msub></math>.
Micro-inertia placed at the center of the brace has radius <math id="S3.SS1.p1.m2" class="ltx_Math" alttext="r_{\text{center}}" display="inline"><msub><mi>r</mi><mtext>center</mtext></msub></math> while micro-inertia placed at the corner of the cubic unit cell has radius <math id="S3.SS1.p1.m3" class="ltx_Math" alttext="r_{\text{corner}}" display="inline"><msub><mi>r</mi><mtext>corner</mtext></msub></math>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="fig/acoustic.pdf" id="S3.F3.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Acoustic metamaterial design problem configuration and results. (A) Design variables of center and corner mass radii (<math id="S3.F3.m4" class="ltx_Math" alttext="r_{\text{center}}" display="inline"><msub><mi>r</mi><mtext>center</mtext></msub></math> and <math id="S3.F3.m5" class="ltx_Math" alttext="r_{\text{corner}}" display="inline"><msub><mi>r</mi><mtext>corner</mtext></msub></math>) and strut radius (<math id="S3.F3.m6" class="ltx_Math" alttext="r_{\text{strut}}" display="inline"><msub><mi>r</mi><mtext>strut</mtext></msub></math>). (B) High symmetry points of the cubic irreducible Brillouin zone. (C) A sample dispersion relation and bandgap (marked by the highlighted zone). The design objective is to generate new acoustic metamaterial designs with target bandgaps. (D) KDE of the estimated likelihood for generated designs. (E) Validation metrics under varying sampling thresholds. (F) Geometries and corresponding dispersion relations of five generated designs with the highest likelihood of satisfying a specified target bandgap (marked as highlighted frequency regions). Here only the fourth design fails to meet a small portion (at around 6 MHz) of the target bandgap, whereas the others meet it. Generated designs for other targets are shown in <span class="ltx_text ltx_font_italic">Appendix, Figs. <a href="#A5.F8" title="Figure 8 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>-<a href="#A5.F10" title="Figure 10 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a></span>.
</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p class="ltx_p">We randomly created 284 sets of geometric parameters <math id="S3.SS1.p2.m1" class="ltx_Math" alttext="\mathbf{x}=(r_{\text{strut}},r_{\text{center}},r_{\text{corner}})" display="inline"><mrow><mi>𝐱</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>r</mi><mtext>strut</mtext></msub><mo>,</mo><msub><mi>r</mi><mtext>center</mtext></msub><mo>,</mo><msub><mi>r</mi><mtext>corner</mtext></msub><mo stretchy="false">)</mo></mrow></mrow></math> with 4 <math id="S3.SS1.p2.m2" class="ltx_Math" alttext="\leq r_{\text{strut}}\leq" display="inline"><mrow><mi></mi><mo>≤</mo><msub><mi>r</mi><mtext>strut</mtext></msub><mo>≤</mo><mi></mi></mrow></math> 6.41, 0 <math id="S3.SS1.p2.m3" class="ltx_Math" alttext="\leq r_{\text{center}}\leq" display="inline"><mrow><mi></mi><mo>≤</mo><msub><mi>r</mi><mtext>center</mtext></msub><mo>≤</mo><mi></mi></mrow></math> 20, and 0 <math id="S3.SS1.p2.m4" class="ltx_Math" alttext="\leq r_{\text{corner}}\leq" display="inline"><mrow><mi></mi><mo>≤</mo><msub><mi>r</mi><mtext>corner</mtext></msub><mo>≤</mo><mi></mi></mrow></math> 20 (unit: µm). The unit cell size was set at <math id="S3.SS1.p2.m5" class="ltx_Math" alttext="a=60" display="inline"><mrow><mi>a</mi><mo>=</mo><mn>60</mn></mrow></math> µm. For each of these designs, we performed Bloch-wave analysis to compute its acoustic dispersion relation.
Bandgap location and width were extracted for each design based on its dispersion relation.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p class="ltx_p">Out of the 284 sets of design variables and bandgap data, we used 227 samples as training data. We first discretized the entire frequency range into 100 intervals, and trained a random forest to predict bandgap existence <math id="S3.SS1.p3.m1" class="ltx_Math" alttext="y\in\{0,1\}" display="inline"><mrow><mi>y</mi><mo>∈</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></math> at a specific interval <math id="S3.SS1.p3.m2" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> for a given design <math id="S3.SS1.p3.m3" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math>. The trained model has a test F1 score of 0.82. The resulting confusion matrix on test data is shown in <span class="ltx_text ltx_font_italic">Appendix, Tab. <a href="#A4.T1" title="Table 1 ‣ Appendix D Test performance of forward prediction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a></span>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p class="ltx_p">To test the inverse design capability of RIGID, we randomly created 10 targets, each containing 1-2 frequency ranges in which bandgap(s) should exist.
We generated 30 designs for each target by sampling from the resulting likelihood distribution over the design space<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup>
              <span class="ltx_tag ltx_tag_note">1</span>
              
              
              
            Note that it is possible for the likelihood to be zero everywhere in the design space when the model believes the target is unachievable. We ignore these cases as it is meaningless and impossible to sample designs from such likelihood distribution.</span></span></span>. Bandgaps were identified from dispersion relations computed using Bloch-wave analysis.
Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>D shows the kernel density estimation (KDE) for the likelihood of the 300 generated designs, conditioned on their target satisfaction.
We use <math id="S3.SS1.p4.m1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><mi class="ltx_font_mathcaligraphic">𝒟</mi></math> and <math id="S3.SS1.p4.m2" class="ltx_Math" alttext="\mathcal{D}_{\text{feas}}" display="inline"><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></math> to represent the complete set of generated designs and the set of generated designs that actually satisfy the target, respectively. Then <math id="S3.SS1.p4.m3" class="ltx_Math" alttext="\mathcal{D}\backslash\mathcal{D}_{\text{feas}}" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">𝒟</mi><mo lspace="0.222em" rspace="0.222em">\</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></mrow></math> denotes the set of generated designs that cannot fulfill the target in reality.
In an ideal scenario, all solutions in <math id="S3.SS1.p4.m4" class="ltx_Math" alttext="\mathcal{D}" display="inline"><mi class="ltx_font_mathcaligraphic">𝒟</mi></math> would satisfy the target, which means <math id="S3.SS1.p4.m5" class="ltx_Math" alttext="\mathcal{D}=\mathcal{D}_{\text{feas}}" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">𝒟</mi><mo>=</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></mrow></math>, and their density profiles should coincide. However, this ideal scenario is not possible due to limited model accuracy. Conveniently, the estimation of target satisfaction likelihood offers us an indicator of what solution is more likely to violate the target. For a reasonable model, most designs in <math id="S3.SS1.p4.m6" class="ltx_Math" alttext="\mathcal{D}\backslash\mathcal{D}_{\text{feas}}" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">𝒟</mi><mo lspace="0.222em" rspace="0.222em">\</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></mrow></math> should have low estimated likelihood values. Consequently, the density of <math id="S3.SS1.p4.m7" class="ltx_Math" alttext="\mathcal{D}_{\text{feas}}" display="inline"><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></math>’s likelihood is a result of shifting some of <math id="S3.SS1.p4.m8" class="ltx_Math" alttext="\mathcal{D}" display="inline"><mi class="ltx_font_mathcaligraphic">𝒟</mi></math>’s density from left (low likelihood) to right (high likelihood). This expectation aligns with the observation in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>D.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p class="ltx_p">When sampling new designs or selecting solutions from generated designs, we can put a <span class="ltx_text ltx_font_italic">sampling threshold</span> <math id="S3.SS1.p5.m1" class="ltx_Math" alttext="\tau\in(0,1)" display="inline"><mrow><mi>τ</mi><mo>∈</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> on the likelihood values to filter out “less promising” solutions. To further examine model behavior and quantify how <math id="S3.SS1.p5.m2" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> affects the inverse design outcome, we define the following metrics:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1" class="ltx_Math" alttext="\begin{split}\text{Selection Rate}&amp;=\frac{|\mathcal{D}_{\phi\geq\tau}|}{|%
\mathcal{D}|},\\
\text{Satisfaction Rate}&amp;=\frac{|\mathcal{D}_{\phi\geq\tau}\cap\mathcal{D}_{%
\text{feas}}|}{|\mathcal{D}_{\phi\geq\tau}|},\\
\text{Average Score}&amp;=\frac{1}{|\mathcal{D}_{\phi\geq\tau}|}\sum_{i=1}^{|%
\mathcal{D}_{\phi\geq\tau}|}q_{i},\\
\end{split}" display="block"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_right" columnalign="right"><mtext>Selection Rate</mtext></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mfrac><mrow><mo stretchy="false">|</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mrow><mi>ϕ</mi><mo>≥</mo><mi>τ</mi></mrow></msub><mo stretchy="false">|</mo></mrow><mrow><mo stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic">𝒟</mi><mo stretchy="false">|</mo></mrow></mfrac></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd class="ltx_align_right" columnalign="right"><mtext>Satisfaction Rate</mtext></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mfrac><mrow><mo stretchy="false">|</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mrow><mi>ϕ</mi><mo>≥</mo><mi>τ</mi></mrow></msub><mo>∩</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></mrow><mo stretchy="false">|</mo></mrow><mrow><mo stretchy="false">|</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mrow><mi>ϕ</mi><mo>≥</mo><mi>τ</mi></mrow></msub><mo stretchy="false">|</mo></mrow></mfrac></mrow><mo>,</mo></mrow></mtd></mtr><mtr><mtd class="ltx_align_right" columnalign="right"><mtext>Average Score</mtext></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mo stretchy="false">|</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mrow><mi>ϕ</mi><mo>≥</mo><mi>τ</mi></mrow></msub><mo stretchy="false">|</mo></mrow></mfrac><mo>⁢</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo stretchy="false">|</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mrow><mi>ϕ</mi><mo>≥</mo><mi>τ</mi></mrow></msub><mo stretchy="false">|</mo></mrow></munderover><msub><mi>q</mi><mi>i</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S3.SS1.p5.m3" class="ltx_Math" alttext="\mathcal{D}_{\phi\geq\tau}" display="inline"><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mrow><mi>ϕ</mi><mo>≥</mo><mi>τ</mi></mrow></msub></math> is the set of generated designs with the likelihood of at least <math id="S3.SS1.p5.m4" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> (i.e., the selected designs) and <math id="S3.SS1.p5.m5" class="ltx_Math" alttext="q_{i}" display="inline"><msub><mi>q</mi><mi>i</mi></msub></math> denotes the percentage overlap between the target and the actual behavior of selected designs.
The satisfaction rate evaluates how many selected designs satisfy the target based on a binary criterion (i.e., whether or not a design satisfies the complete target), whereas the average score provides a soft measure where partial satisfaction is also counted. The average score is lower-bounded by the satisfaction rate.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p class="ltx_p">As shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>E, the selection rate decreases when <math id="S3.SS1.p6.m1" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> increases since more solutions are filtered out. On the other hand, both the satisfaction rate and the average score increase with <math id="S3.SS1.p6.m2" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math>, which indicates a high correlation between the estimated likelihood of a solution and its probability of actually achieving the target. As <math id="S3.SS1.p6.m3" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> reaches 0.6, the satisfaction rate and the average score reach 1, indicating that all generated designs satisfy their targets. When sampling or selecting new solutions, we can use the sample threshold <math id="S3.SS1.p6.m4" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> to tune the trade-off between exploitation and exploration — a low <math id="S3.SS1.p6.m5" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> favors exploration as sampled solutions will cover a larger area of the design space, while a high <math id="S3.SS1.p6.m6" class="ltx_Math" alttext="\tau" display="inline"><mi>τ</mi></math> favors exploitation as sampled solutions will have a higher chance of satisfying the target.</p>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<p class="ltx_p">Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>F visualizes the geometries and dispersion relations of designs generated based on a randomly created bandgap target. Only the top five designs with the highest likelihood values are shown.
In this example, our method generates geometrically different designs that have a high probability of achieving target bandgaps, each yielding a slightly different dispersion relation. This is promising in design applications requiring other material properties, such as dynamic wave velocity or quasi-static stiffness, in which the user can select from a menu of designs with the same target bandgap but other varying properties. Generated designs based on the other nine bandgap targets can be found in <span class="ltx_text ltx_font_italic">Appendix, Figs. <a href="#A5.F8" title="Figure 8 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>-<a href="#A5.F10" title="Figure 10 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a></span>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p class="ltx_p">Optical metasurfaces are artificially engineered systems that can support exotic light propagation building on subwavelength inclusions <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">pendry2000negative</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">yu2011light</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">kildishev2013planar</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">cui2014coding</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">bukhari2019metasurfaces</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">hu2021review</span>]</cite>. Among a diverse array of devices, metamaterial absorbers <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">landy2008perfect</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2010infrared</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">hao2010high</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">watts2012metamaterial</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">cui2014plasmonic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2017experimental</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lee2018complete</span>]</cite> have been intensely studied for medical imaging, sensing, and wireless communications.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p class="ltx_p">In this case study, we consider four types of cross-sections (<math id="S3.SS2.p2.m1" class="ltx_Math" alttext="c\in\{1,2,3,4\}" display="inline"><mrow><mi>c</mi><mo>∈</mo><mrow><mo stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false">}</mo></mrow></mrow></math>) chosen from the literature (Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>B). It is assumed that a 3D geometric instance is composed of a stack of three layers of prismatic unit cells, each of which is vertically extruded and stacked (Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>A). The geometries constructed in this way can be regarded as an instantiation of multilayered metasurfaces <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhou2018multilayer</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">li2018wideband</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">marino2021harmonic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">malek2022multifunctional</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2023high</span>]</cite>, which offer richer design freedom than the single-layer counterpart. The height of each layer (<math id="S3.SS2.p2.m2" class="ltx_Math" alttext="h_{l},l=1,2,3" display="inline"><mrow><mrow><mrow><msub><mi>h</mi><mi>l</mi></msub><mo>,</mo><mi>l</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></mrow></math>) is allowed to continuously vary between 50 and 150 nm. Herein we do not consider parametric variations of a given type of unit cell cross-section; yet those can be trivially incorporated in the proposed design framework if necessary.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="fig/optical.pdf" id="S3.F4.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Optical metasurface design problem configuration and results. (A-B) Design variables (materials, layer heights, and cross-section geometry types). (C) A sample absorbance spectrum and the wavelength intervals (highlighted wavelength regions) corresponding to absorbance above the threshold <math id="S3.F4.m3" class="ltx_Math" alttext="t" display="inline"><mi>t</mi></math>. The design objective is to generate new optical metasurface designs that exhibit higher absorbance than a threshold <math id="S3.F4.m4" class="ltx_Math" alttext="t" display="inline"><mi>t</mi></math> at the user-defined wavelength interval(s). (D) KDE of the estimated likelihood for generated designs. (E) Validation metrics under varying sampling thresholds. (F) Designs (geometries and material selections) and corresponding absorbance spectra of five generated metasurfaces with the highest likelihood of satisfying specified target high-absorbance regions (marked as highlighted wavelength regions). Here all five designs satisfy the target. Generated designs for other targets are shown in <span class="ltx_text ltx_font_italic">Appendix, Figs. <a href="#A5.F11" title="Figure 11 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>-<a href="#A5.F12" title="Figure 12 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a></span>.
</figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p class="ltx_p">We also design the material of each layer (<math id="S3.SS2.p3.m1" class="ltx_Math" alttext="m_{l},l=1,2,3" display="inline"><mrow><mrow><mrow><msub><mi>m</mi><mi>l</mi></msub><mo>,</mo><mi>l</mi></mrow><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></mrow></math>). Three dielectric materials of interest, each of which is assigned to a different color in Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>A, are Ti (red), Si (blue), and Ge (yellow). In general, a dielectric material is characterized through a complex refractive index <math id="S3.SS2.p3.m2" class="ltx_Math" alttext="\tilde{n}\in\mathbb{C}" display="inline"><mrow><mover accent="true"><mi>n</mi><mo>~</mo></mover><mo>∈</mo><mi>ℂ</mi></mrow></math> defined as <math id="S3.SS2.p3.m3" class="ltx_Math" alttext="\tilde{n}=n+jk" display="inline"><mrow><mover accent="true"><mi>n</mi><mo>~</mo></mover><mo>=</mo><mrow><mi>n</mi><mo>+</mo><mrow><mi>j</mi><mo>⁢</mo><mi>k</mi></mrow></mrow></mrow></math>, where <math id="S3.SS2.p3.m4" class="ltx_Math" alttext="j=\sqrt{-1}" display="inline"><mrow><mi>j</mi><mo>=</mo><msqrt><mrow><mo>−</mo><mn>1</mn></mrow></msqrt></mrow></math> is the imaginary unit, <math id="S3.SS2.p3.m5" class="ltx_Math" alttext="n\in\mathbb{R}" display="inline"><mrow><mi>n</mi><mo>∈</mo><mi>ℝ</mi></mrow></math> involves the speed at which the light propagates through the material, and <math id="S3.SS2.p3.m6" class="ltx_Math" alttext="k\in\mathbb{R}" display="inline"><mrow><mi>k</mi><mo>∈</mo><mi>ℝ</mi></mrow></math> is the extinction coefficient that dictates the energy loss due to the material.
Within the frequency regime of interest, those exhibit nonlinear dispersion; both the real and imaginary terms in general are a non-analytic function of excitation wavelength <math id="S3.SS2.p3.m7" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math>, i.e., <math id="S3.SS2.p3.m8" class="ltx_Math" alttext="n(s)" display="inline"><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math> and <math id="S3.SS2.p3.m9" class="ltx_Math" alttext="k(s)" display="inline"><mrow><mi>k</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math>. In addition, the impact of the same material choice on the spectral response <math id="S3.SS2.p3.m10" class="ltx_Math" alttext="A(s)" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math> varies depending on the layer location at which the material is placed. Thus the highlight of this case study is the combinatorial nature of design, whose spectral responses are affected by the joint contributions of geometry and material.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p class="ltx_p">Based on the above configuration, we randomly sampled 258 sets of design variables <math id="S3.SS2.p4.m1" class="ltx_Math" alttext="\mathbf{x}=(c,h_{1},h_{2},h_{3},m_{1},m_{2},m_{3})" display="inline"><mrow><mi>𝐱</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>c</mi><mo>,</mo><msub><mi>h</mi><mn>1</mn></msub><mo>,</mo><msub><mi>h</mi><mn>2</mn></msub><mo>,</mo><msub><mi>h</mi><mn>3</mn></msub><mo>,</mo><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub><mo>,</mo><msub><mi>m</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow></mrow></math> and computed their corresponding absorbance spectra using wave analysis. We set <math id="S3.SS2.p4.m2" class="ltx_Math" alttext="t=0.9" display="inline"><mrow><mi>t</mi><mo>=</mo><mn>0.9</mn></mrow></math> as the absorbance threshold, so that “high” absorbance means the absorbance <math id="S3.SS2.p4.m3" class="ltx_Math" alttext="A(s)" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math> is no less than 0.9. We trained a random forest on 206 training data (i.e., 80% of the 258 designs and corresponding absorbance spectra) to predict whether “high” absorbance is presented (i.e., the binary indicator <math id="S3.SS2.p4.m4" class="ltx_Math" alttext="y=1" display="inline"><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow></math>) at a wavelength <math id="S3.SS2.p4.m5" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> for a given design <math id="S3.SS2.p4.m6" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math>. The trained random forest has a test F1 score of 0.83. The confusion matrix on test data is shown in <span class="ltx_text ltx_font_italic">Appendix, Tab. <a href="#A4.T2" title="Table 2 ‣ Appendix D Test performance of forward prediction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a></span>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p class="ltx_p">Note that this problem involves inverse design with both continuous and categorical variables, which common optimization and generative modeling-based inverse design cannot handle well without special treatment <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2020bayesian</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">ma2020vaem</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">xu2018synthesizing</span>]</cite>. On the other hand, our random forest-based method can naturally address such mixed-variable problems without any issues.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p class="ltx_p">Similar to the acoustic metamaterial design problem, we use 10 randomly created targets to evaluate the inverse design performance of RIGID, except that here a target is represented as the wavelength range(s) within which absorbance should be at least 0.9. We generated 100 designs for each target by sampling from the estimated likelihood distribution. Among the 1,000 generated solutions, we successfully conducted wave analysis for 911 designs and obtained their absorbance spectra. Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>D shows the KDE for the likelihood of these 911 designs, conditioned on their target satisfaction. The densities share similar behavior as in the acoustic problem (Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>D) —unsatisfied/infeasible designs <math id="S3.SS2.p6.m1" class="ltx_Math" alttext="\mathcal{D}\backslash\mathcal{D}_{\text{feas}}" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">𝒟</mi><mo lspace="0.222em" rspace="0.222em">\</mo><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></mrow></math> are concentrated at low likelihood regions, which causes the likelihood density of satisfied/feasible designs <math id="S3.SS2.p6.m2" class="ltx_Math" alttext="\mathcal{D}_{\text{feas}}" display="inline"><msub><mi class="ltx_font_mathcaligraphic">𝒟</mi><mtext>feas</mtext></msub></math> to be a result of shifting some of <math id="S3.SS2.p6.m3" class="ltx_Math" alttext="\mathcal{D}" display="inline"><mi class="ltx_font_mathcaligraphic">𝒟</mi></math>’s density from left (low likelihood) to right (high likelihood). The sampling threshold and metrics relation shown in Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>E also follow the same trend as in the acoustic problem (Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>E), which again demonstrates a strong positive correlation between the estimated likelihood and the probability of generated designs actually achieving their targets.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p class="ltx_p">Figure <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>F shows generated optical metasurface designs with the top five likelihood estimations for a randomly created target. While the materials, cross-section geometries, and layer heights of generated designs can be different, all the designs satisfy the target (Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>F, right panel). To further enhance the diversity of final solutions, we can use sampling strategies such as the one proposed in Ref. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">chan2021metaset</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lee2023t</span>]</cite> to identify a subset (of generated solutions) that simultaneously exhibits high likelihood and high diversity. Generated designs based on the other nine targets can be found in <span class="ltx_text ltx_font_italic">Appendix, Figs. <a href="#A5.F11" title="Figure 11 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>-<a href="#A5.F12" title="Figure 12 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a></span>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Synthetic Design Problems for Rapid Validation and Visualization</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p class="ltx_p">While the above metamaterial design problems represent practical use cases, the validation study is time-consuming due to the expensive computation of metamaterials’ responses such as dispersion relations and absorbance spectra. To allow fast validation of the proposed method and easier inspection of the estimated likelihood in the design space, we create two synthetic case studies. Both problems have 2-dimensional “design spaces” that allow easy visualization.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="fig/synthetic_data.pdf" id="S3.F5.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Synthetic data creation for (A) the SqExp problem and (B) the SupSin problem. For each problem, the left panel shows 100 functions with randomly sampled parameters <math id="S3.F5.m6" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.F5.m7" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>. We treat <math id="S3.F5.m8" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.F5.m9" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> as synthetic design variables, and the corresponding functions as quantitative responses (e.g., absorbance spectra of optical metasurfaces). The right panel shows qualitative responses (e.g., high-absorbance wavelength ranges or bandgaps) are simulated by synthetic ranges, derived by thresholding the 100 functions (Equations <a href="#S3.E2" title="In SqExp Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S3.E3" title="In SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> with threshold <math id="S3.F5.m10" class="ltx_Math" alttext="t" display="inline"><mi>t</mi></math>=0.9).</figcaption>
</figure>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">SqExp Problem</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p class="ltx_p">To construct the first synthetic problem, we used a <span class="ltx_text ltx_font_italic">squared exponential function</span> with tunable parameters <math id="S3.SS3.SSS0.Px1.p1.m1" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px1.p1.m2" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> to mimic the quantitative functional response of metamaterials. The qualitative response (e.g., “high” or “low” energy absorption at a wavelength) is defined as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1" class="ltx_Math" alttext="I(a,b;s)=\begin{cases}0,&amp;\text{if $z=\exp\left(-{\left(\frac{s-a}{0.3b+0.1}%
\right)^{2}}\right)&lt;t$}\\
1,&amp;\text{otherwise}\end{cases}," display="block"><mrow><mrow><mrow><mi>I</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>;</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mtext>if </mtext><mrow><mi>z</mi><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mo>−</mo><msup><mrow><mo>(</mo><mstyle displaystyle="false"><mfrac><mrow><mi>s</mi><mo>−</mo><mi>a</mi></mrow><mrow><mrow><mn>0.3</mn><mo>⁢</mo><mi>b</mi></mrow><mo>+</mo><mn>0.1</mn></mrow></mfrac></mstyle><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>&lt;</mo><mi>t</mi></mrow></mrow></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mn>1</mn><mo>,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mtext>otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.m3" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> represents quantitative response and <math id="S3.SS3.SSS0.Px1.p1.m4" class="ltx_Math" alttext="t" display="inline"><mi>t</mi></math> is a threshold that converts <math id="S3.SS3.SSS0.Px1.p1.m5" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> into a qualitative response <math id="S3.SS3.SSS0.Px1.p1.m6" class="ltx_Math" alttext="I(a,b;s)" display="inline"><mrow><mi>I</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>;</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math>. Specifically, <math id="S3.SS3.SSS0.Px1.p1.m7" class="ltx_Math" alttext="I(a,b;s)=1" display="inline"><mrow><mrow><mi>I</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>;</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math> can mean the existence of a bandgap or high absorbance at a frequency <math id="S3.SS3.SSS0.Px1.p1.m8" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math>. Then <math id="S3.SS3.SSS0.Px1.p1.m9" class="ltx_Math" alttext="\{s|I(a,b;s)=1\}" display="inline"><mrow><mo stretchy="false">{</mo><mi>s</mi><mo lspace="0em" rspace="0em">|</mo><mrow><mrow><mi>I</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>;</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow><mo stretchy="false">}</mo></mrow></math> represents a range of <math id="S3.SS3.SSS0.Px1.p1.m10" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> that mimics our design targets, such as the bandgap or the frequency range of high absorbance. By varying <math id="S3.SS3.SSS0.Px1.p1.m11" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px1.p1.m12" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>, we can produce different synthetic responses and ranges. Therefore, we can use <math id="S3.SS3.SSS0.Px1.p1.m13" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px1.p1.m14" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> as synthetic design variables. There is a clear relation between these design variables and the range that Eq. <a href="#S3.E2" title="In SqExp Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> creates — <math id="S3.SS3.SSS0.Px1.p1.m15" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px1.p1.m16" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> control the center location and the width of the range, respectively.</p>
</div>
<div id="S3.SS3.SSS0.Px1.p2" class="ltx_para">
<p class="ltx_p">In this design problem, we sampled 100 sets of <math id="S3.SS3.SSS0.Px1.p2.m1" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px1.p2.m2" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> uniformly at random. We set <math id="S3.SS3.SSS0.Px1.p2.m3" class="ltx_Math" alttext="t" display="inline"><mi>t</mi></math> as 0.9. Based on Eq. <a href="#S3.E2" title="In SqExp Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we obtained the corresponding responses (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>A). These sets of <math id="S3.SS3.SSS0.Px1.p2.m4" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math>, <math id="S3.SS3.SSS0.Px1.p2.m5" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>, and responses constitute a dataset for training and testing our model.</p>
</div>
</section>
<section id="S3.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">SupSin Problem</h4>

<div id="S3.SS3.SSS0.Px2.p1" class="ltx_para">
<p class="ltx_p">Another synthetic design problem was constructed by replacing
the squared exponential function in the SqExp problem with a <span class="ltx_text ltx_font_italic">superposed sine function</span>. Given synthetic design variables <math id="S3.SS3.SSS0.Px2.p1.m1" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px2.p1.m2" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>, we can produce qualitative responses using the following equation:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1" class="ltx_Math" alttext="I(a,b;s)=\begin{cases}0,&amp;\text{if $z=\sin\left(2\pi(s+a)\right)+\sin\left(3\pi%
(s+b)\right)&lt;t$}\\
1,&amp;\text{otherwise}\end{cases}." display="block"><mrow><mrow><mrow><mi>I</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>;</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mn>0</mn><mo>,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mtext>if </mtext><mrow><mi>z</mi><mo>=</mo><mrow><mrow><mi>sin</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo>+</mo><mi>a</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mi>sin</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mn>3</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>s</mi><mo>+</mo><mi>b</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>&lt;</mo><mi>t</mi></mrow></mrow></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mn>1</mn><mo>,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mtext>otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Same as in the SqExp problem, we set <math id="S3.SS3.SSS0.Px2.p1.m3" class="ltx_Math" alttext="t=0.9" display="inline"><mrow><mi>t</mi><mo>=</mo><mn>0.9</mn></mrow></math> and created a dataset with 100 sets of synthetic design variables and corresponding ranges derived from synthetic responses (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>B).
Unlike the squared exponential function, the superposed sine function can be multimodal, which means it can result in multiple synthetic ranges to mimic, for example, multiple bandgaps. The bandgap locations are controlled by <math id="S3.SS3.SSS0.Px2.p1.m4" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px2.p1.m5" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>.</p>
</div>
<div id="S3.SS3.SSS0.Px2.p2" class="ltx_para">
<p class="ltx_p">For each synthetic example, we split the data into 80 training data and 20 test data, and trained a random forest, with the same hyperparameter settings as the other problems, to predict the binary indicators <math id="S3.SS3.SSS0.Px2.p2.m1" class="ltx_Math" alttext="I(a,b;s)" display="inline"><mrow><mi>I</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>;</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math>. The F1 scores are 0.85 and 0.86 for the SqExp and the SupSin problems, respectively. The resulting confusion matrices are shown in <span class="ltx_text ltx_font_italic">Appendix, Tables <a href="#A4.T3" title="Table 3 ‣ Appendix D Test performance of forward prediction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>-<a href="#A4.T4" title="Table 4 ‣ Appendix D Test performance of forward prediction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></span>. We evaluated the inverse design performance with the trained models.</p>
</div>
<figure id="S3.F6" class="ltx_figure"><img src="fig/synthetic_results.pdf" id="S3.F6.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualization of estimated likelihood and validation metrics for synthetic problems. (A) Likelihood function values for randomly created design targets. Orange lines show boundaries of actual feasible regions associated with the targets. (B) Likelihood function values estimated by random forests with varying numbers of decision trees. The design target is set as <math id="S3.F6.m3" class="ltx_Math" alttext="\{[0.45,0.48]\}" display="inline"><mrow><mo stretchy="false">{</mo><mrow><mo stretchy="false">[</mo><mn>0.45</mn><mo>,</mo><mn>0.48</mn><mo stretchy="false">]</mo></mrow><mo stretchy="false">}</mo></mrow></math> for the SqExp problem and <math id="S3.F6.m4" class="ltx_Math" alttext="\{[0.63,0.68],[0.69,0.71]\}" display="inline"><mrow><mo stretchy="false">{</mo><mrow><mo stretchy="false">[</mo><mn>0.63</mn><mo>,</mo><mn>0.68</mn><mo stretchy="false">]</mo></mrow><mo>,</mo><mrow><mo stretchy="false">[</mo><mn>0.69</mn><mo>,</mo><mn>0.71</mn><mo stretchy="false">]</mo></mrow><mo stretchy="false">}</mo></mrow></math> for the SupSin problem. (C) Validation metrics for inverse design generation.</figcaption>
</figure>
<div id="S3.SS3.SSS0.Px2.p3" class="ltx_para">
<p class="ltx_p">Due to the fast evaluation of Equations <a href="#S3.E2" title="In SqExp Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S3.E3" title="In SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we can exhaust all the possible solutions in the design space to obtain the ground-truth feasible region(s) for a target. Figure <a href="#S3.F6" title="Figure 6 ‣ SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>A shows the estimated likelihood values and the ground-truth feasible regions under randomly created targets. In general, high-likelihood regions match actual feasible regions well, which further demonstrates the effectiveness of RIGID. We can also observe that feasible regions in the SqExp and the SupSin problems follow distinct patterns. In the SqExp problem, <math id="S3.SS3.SSS0.Px2.p3.m1" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px2.p3.m2" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> control the center location and the width of the output range, respectively. Therefore, the position of the feasible region along the <math id="S3.SS3.SSS0.Px2.p3.m3" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math>-axis moves with the location of the target range, while the feasible region gradually shrinks as <math id="S3.SS3.SSS0.Px2.p3.m4" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> decreases since the decrease of <math id="S3.SS3.SSS0.Px2.p3.m5" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> (i.e., output range width) causes the choice of <math id="S3.SS3.SSS0.Px2.p3.m6" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> (i.e., output range center location) to be more restricted to fit the target range. In the SupSin problem, there might be multiple bandgaps appearing at the peaks of the superposed sine function in Eq. <a href="#S3.E3" title="In SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Design variables <math id="S3.SS3.SSS0.Px2.p3.m7" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S3.SS3.SSS0.Px2.p3.m8" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> control bandgap locations by translating each sine function. Due to the sine function’s periodicity, we can obtain multiple feasible regions along both <math id="S3.SS3.SSS0.Px2.p3.m9" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math>- and <math id="S3.SS3.SSS0.Px2.p3.m10" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>-axes.
Figure <a href="#S3.F6" title="Figure 6 ‣ SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>A shows that the likelihood estimation by RIGID successfully captured the above-mentioned patterns of feasible regions.</p>
</div>
<div id="S3.SS3.SSS0.Px2.p4" class="ltx_para">
<p class="ltx_p">Figure <a href="#S3.F6" title="Figure 6 ‣ SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>B demonstrates how the estimated likelihood varies when increasing the number of trees in a random forest. With a single decision tree, the estimated likelihood function is almost a binary function and highly inaccurate. The likelihood in the SqExp case is even zero everywhere, which makes it impossible to sample designs based on the likelihood. As the number of trees increases, the likelihood function becomes smoother and eventually converges.</p>
</div>
<div id="S3.SS3.SSS0.Px2.p5" class="ltx_para">
<p class="ltx_p">Besides these qualitative visual inspections, we also calculated the metrics proposed in Eq. <a href="#S3.E1" title="In 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, as shown in Fig. <a href="#S3.F6" title="Figure 6 ‣ SupSin Problem ‣ 3.3 Synthetic Design Problems for Rapid Validation and Visualization ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>C. For each of the two synthetic problems, these metrics were computed on 500 designs generated by giving five random target ranges. Again, the satisfaction rate and the average score increase with the sampling threshold, indicating a strong correlation between the sampling threshold and the probability of generated designs actually achieving their targets. In both problems, all the selected designs satisfy their targets (i.e., the satisfaction rates and average scores reach 1) when the sampling threshold reaches 0.8.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Summary and Outlook</h2>

<div id="S4.p1" class="ltx_para">
<p class="ltx_p">We proposed RIGID, a single-shot inverse design method that generates metamaterials to satisfy qualitative behaviors of functional responses. Such qualitative behaviors are important design targets in many applications such as tailoring bandgaps of acoustic metamaterials for wave-guiding, focusing, and vibration mitigation, or tailoring the absorption level of optical metasurfaces at certain wavelengths for medical sensing, imaging, and communication applications. Unlike most existing inverse design methods that require training an inverse model to map targets to designs, the RIGID method takes advantage of the random forest’s interpretability and derives the likelihood of target satisfaction by probing the trained forward model. Incorporated with MCMC, one can sample a desired number of new designs based on the estimated likelihood. Therefore, RIGID functions as a generative model that can capture the conditional distribution of satisfying designs given a target, or in other words, the one-to-many mapping from the target to satisfying designs. Using both real-world and synthetic design problems, we demonstrated that RIGID is efficient and effective on datasets with training sample sizes smaller than 250. Thus, RIGID is particularly useful when data collection is expensive, as in many cases where high-fidelity simulation or experimental data are needed. We used both qualitative and quantitative approaches to validate the proposed method. The quantitative results revealed a strong correlation between the estimated likelihood of a solution and its probability of actually achieving the target, which demonstrated the effectiveness of the likelihood estimation. Due to the fast evaluation of output responses and the transparency of ground-truth solutions, the proposed synthetic problems can be used for future benchmarking studies of metamaterial design problems.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p class="ltx_p">While we address qualitative design targets in this study, the idea of using random forest-based models for inverse design has the potential to generalize to quantitative targets. Such problems can be, for example, generating optical metasurface designs with specific optical spectra <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2018generative</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">ma2019probabilistic</span>]</cite>, generating functional materials with target nonlinear constitutive relations <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">lew2023single</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">vlassis2023denoising</span>]</cite>, or generating programmable metamaterials with prescribed functional responses <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2022digital</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">lin2023mechanical</span>]</cite>. It is also straightforward to adjust the target to achieve multifunctionality (e.g., negative/positive Poisson’s ratio under low/high compression rate <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">bossart2021oligomodal</span>]</cite>).</p>
</div>
<div id="S4.p3" class="ltx_para">
<p class="ltx_p">Although this study only demonstrates the RIGID method on parametric design (i.e., designs are represented by geometric and/or material parameters), the method also applies to shape or topological design problems where the shape or topology of designs can vary without being restricted to a limited number of geometric parameters <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2018generative</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">jiang2019free</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">ma2019probabilistic</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">wen2020robust</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">an2021multifunctional</span>]</cite>. In those cases, as valid designs only lie on a lower-dimensional manifold of the design space, the likelihood of target satisfaction will be zero almost everywhere in the original design space. Thus before applying RIGID, we need to obtain a latent representation that compactly captures the manifold of valid designs <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2020deep</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">chen2023gan</span>]</cite>, and use the latent representation as design variables for inverse design.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx1.p1" class="ltx_para">
<p class="ltx_p">This work was supported by the startup funds from the J. Mike Walker ’66 Department of Mechanical Engineering at Texas A&amp;M University, the National Science Foundation (NSF) BRITE Fellow program (CMMI 2227641), the NSF CSSI program (OAC 1835782), the Kansas City National Security Campus (PDRD #705288), and NSF CAREER Award (CMMI-2142460). R.S. acknowledges financial support from the NSF Graduate Research Fellowship Program.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul id="bib.L1" class="ltx_biblist">
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Works on Single-Shot Inverse Design</h2>

<div id="A1.p1" class="ltx_para">
<p class="ltx_p">Figure <a href="#A1.F7" title="Figure 7 ‣ Appendix A Related Works on Single-Shot Inverse Design ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the schematic diagrams of three mainstream machine learning models for single-shot inverse design of metamaterials.</p>
</div>
<figure id="A1.F7" class="ltx_figure"><img src="fig/support_past_work.pdf" id="A1.F7.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Three major machine learning models for single-shot inverse design. Note that these are only conceptual plots and the networks can be more complicated in reality. Also, due to the diversity and complexity of conditional generative model architectures, we only show the network for design generation based on commonly used models (e.g., generators in cGANs or decoders in cVAEs), while omitting networks that are necessary for training (e.g., discriminators in cGANs or encoders in cVAEs).</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Explanation of Step 2 in RIGID</h2>

<div id="A2.p1" class="ltx_para">
<p class="ltx_p">The purpose of Step 2 is to obtain the intersection of relevant design space regions for all the ranges of <math id="A2.p1.m1" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> in a target. We are approximating this goal by simply obtaining the intersection of relevant leaves. However, some non-intersecting leaves may still have intersecting design space regions. When assigning the probability to the intersecting region of two non-intersecting leaves <math id="A2.p1.m2" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> and <math id="A2.p1.m3" class="ltx_Math" alttext="B" display="inline"><mi>B</mi></math>, we need to consider the predicted probabilities at both leaves (<math id="A2.p1.m4" class="ltx_Math" alttext="P_{A}" display="inline"><msub><mi>P</mi><mi>A</mi></msub></math> and <math id="A2.p1.m5" class="ltx_Math" alttext="P_{B}" display="inline"><msub><mi>P</mi><mi>B</mi></msub></math>). Specifically, the assigned probability at this intersecting region should be <math id="A2.p1.m6" class="ltx_Math" alttext="P_{A}P_{B}" display="inline"><mrow><msub><mi>P</mi><mi>A</mi></msub><mo>⁢</mo><msub><mi>P</mi><mi>B</mi></msub></mrow></math>, which can be small. Therefore, we adopt the simplification of only considering the intersection of relevant leaves and ignoring the intersecting regions associated with non-intersecting leaves. The results also demonstrate that this is a reasonable approximation.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Computational Methods for Data Collection and Validation</h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Computation of Acoustic Dispersion Relations</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p class="ltx_p">We performed Bloch-wave analysis in COMSOL Multiphysics to compute the dispersion relations of acoustic metamaterials. Poisson’s ratio of 0.49, Young’s modulus of 2.7 GPa, and density of 1170 kg/m<sup class="ltx_sup">3</sup> were set as material properties with <math id="A3.SS1.p1.m2" class="ltx_Math" alttext="\sim 1.5\times 10^{4}" display="inline"><mrow><mi></mi><mo>∼</mo><mrow><mn>1.5</mn><mo lspace="0.222em" rspace="0.222em">×</mo><msup><mn>10</mn><mn>4</mn></msup></mrow></mrow></math> mesh elements per unit cell.
We used Floquet-Bloch periodic boundary conditions to obtain the first 60 eigenfrequencies along all symmetry domains of the cubic irreducible Brillouin zone (Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>B) for all lattices, thus generating a dispersion relation.</p>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Computation of Optical Absorbance Spectra</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p class="ltx_p">We computed the absorbance spectra for optical metasurfaces using wave analysis inspired by Zhang et al. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2023high</span>]</cite>. The RF Module of COMSOL Multiphysics<sup class="ltx_sup">®</sup> <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">comsol2020</span>]</cite> was used to evaluate the spectral response of concern, which is the energy absorbance <math id="A3.SS2.p1.m1" class="ltx_Math" alttext="A(s)" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow></math> in the visible regime (380-700 nm). An absorbance spectrum is computed with respect to 33 wavelength components <math id="A3.SS2.p1.m2" class="ltx_Math" alttext="s_{k}" display="inline"><msub><mi>s</mi><mi>k</mi></msub></math> that are uniformly discretized over the specified range. An incident plane wave is assumed to be given from the port, located at the top face of the analysis domain. We set the periodicity of the analysis domain as 400 nm. The periodic boundary condition on electromagnetic fields is imposed on the lateral faces of the analysis domain. A substrate made of SiO<sub class="ltx_sub">2</sub> is placed right below a given unit cell instance (the black layers in Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>A-B). With full electric fields computed through the wave analysis, the energy absorbance at a single wavelength <math id="A3.SS2.p1.m4" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> is quantified as <math id="A3.SS2.p1.m5" class="ltx_Math" alttext="A(s)=1-|S_{11}(s)|^{2}" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="false">|</mo><mrow><msub><mi>S</mi><mn>11</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></mrow></mrow></math>, where <math id="A3.SS2.p1.m6" class="ltx_Math" alttext="S_{ij}" display="inline"><msub><mi>S</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math> is the component of the <math id="A3.SS2.p1.m7" class="ltx_Math" alttext="S" display="inline"><mi>S</mi></math>-parameter matrix that specifies energy transfer between ports. We use the data presented in Ref. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">aspnes1983dielectric</span>]</cite> to set the material dispersion of the dielectric.</p>
</div>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Test performance of forward prediction</h2>

<div id="A4.p1" class="ltx_para">
<p class="ltx_p">Test data for all the design problems are designs <math id="A4.p1.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>𝐱</mi></math> (that the random forests have never seen during training) and their corresponding qualitative behaviors <math id="A4.p1.m2" class="ltx_Math" alttext="y\in\{0,1\}" display="inline"><mrow><mi>y</mi><mo>∈</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></math> based on functional responses.</p>
</div>
<div id="A4.p2" class="ltx_para">
<p class="ltx_p">In the acoustic metamaterial design problem, we have 57 test designs, yielding 5,700 test points as the entire frequency range of dispersion relations is discretized into 100 intervals for each design. In the optical metasurface design problem, we have 52 test designs, with each functional response discretized into 33 points, which yields 1,716 test points in total. In each of the synthetic design problems, we have 20 synthetic test designs, with each synthetic response discretized into 100 points. This results in 2,000 test data points in total. Confusion matrices showing test performances are in Tables <a href="#A4.T1" title="Table 1 ‣ Appendix D Test performance of forward prediction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#A4.T4" title="Table 4 ‣ Appendix D Test performance of forward prediction ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="A4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Confusion matrix on test data in the acoustic metamaterial design problem. The test F1 score is 0.82.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td" colspan="2"></td>
<td class="ltx_td ltx_align_center" colspan="2">Predicted</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td"></td>
<td class="ltx_td ltx_border_r"></td>
<td class="ltx_td ltx_align_center">Yes</td>
<td class="ltx_td ltx_align_center">No</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center" rowspan="2">
<div class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:29.2pt;vertical-align:-11.1pt;"><span class="ltx_transformed_inner" style="width:29.2pt;transform:translate(-11.11pt,0pt) rotate(-90deg) ;">
<p class="ltx_p">Actual</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_t">393</td>
<td class="ltx_td ltx_align_center ltx_border_t">131</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r">No</td>
<td class="ltx_td ltx_align_center ltx_border_b">46</td>
<td class="ltx_td ltx_align_center ltx_border_b">5130</td>
</tr>
</table>
</figure>
<figure id="A4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Confusion matrix on test data in the optical metasurface design problem. The test F1 score is 0.83.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td" colspan="2"></td>
<td class="ltx_td ltx_align_center" colspan="2">Predicted</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td"></td>
<td class="ltx_td ltx_border_r"></td>
<td class="ltx_td ltx_align_center">Yes</td>
<td class="ltx_td ltx_align_center">No</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center" rowspan="2">
<div class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:29.2pt;vertical-align:-11.1pt;"><span class="ltx_transformed_inner" style="width:29.2pt;transform:translate(-11.11pt,0pt) rotate(-90deg) ;">
<p class="ltx_p">Actual</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_t">776</td>
<td class="ltx_td ltx_align_center ltx_border_t">157</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r">No</td>
<td class="ltx_td ltx_align_center ltx_border_b">151</td>
<td class="ltx_td ltx_align_center ltx_border_b">632</td>
</tr>
</table>
</figure>
<figure id="A4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Confusion matrix on test data in the SqExp problem. The test F1 score is 0.85.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td" colspan="2"></td>
<td class="ltx_td ltx_align_center" colspan="2">Predicted</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td"></td>
<td class="ltx_td ltx_border_r"></td>
<td class="ltx_td ltx_align_center">Yes</td>
<td class="ltx_td ltx_align_center">No</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center" rowspan="2">
<div class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:29.2pt;vertical-align:-11.1pt;"><span class="ltx_transformed_inner" style="width:29.2pt;transform:translate(-11.11pt,0pt) rotate(-90deg) ;">
<p class="ltx_p">Actual</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_t">229</td>
<td class="ltx_td ltx_align_center ltx_border_t">68</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r">No</td>
<td class="ltx_td ltx_align_center ltx_border_b">13</td>
<td class="ltx_td ltx_align_center ltx_border_b">1690</td>
</tr>
</table>
</figure>
<figure id="A4.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Confusion matrix on test data in the SupSin problem. The test F1 score is 0.86.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td" colspan="2"></td>
<td class="ltx_td ltx_align_center" colspan="2">Predicted</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td"></td>
<td class="ltx_td ltx_border_r"></td>
<td class="ltx_td ltx_align_center">Yes</td>
<td class="ltx_td ltx_align_center">No</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center" rowspan="2">
<div class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:29.2pt;vertical-align:-11.1pt;"><span class="ltx_transformed_inner" style="width:29.2pt;transform:translate(-11.11pt,0pt) rotate(-90deg) ;">
<p class="ltx_p">Actual</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes</td>
<td class="ltx_td ltx_align_center ltx_border_t">355</td>
<td class="ltx_td ltx_align_center ltx_border_t">81</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r">No</td>
<td class="ltx_td ltx_align_center ltx_border_b">37</td>
<td class="ltx_td ltx_align_center ltx_border_b">1527</td>
</tr>
</table>
</figure>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Generated Designs and Corresponding Responses</h2>

<div id="A5.p1" class="ltx_para">
<p class="ltx_p">Figures <a href="#A5.F8" title="Figure 8 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>-<a href="#A5.F12" title="Figure 12 ‣ Appendix E Generated Designs and Corresponding Responses ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> show the rest of generated designs and their corresponding responses in addition to those in Figures <a href="#S3.F3" title="Figure 3 ‣ 3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>F and <a href="#S3.F4" title="Figure 4 ‣ 3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths ‣ 3 Results ‣ Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>F.</p>
</div>
<figure id="A5.F8" class="ltx_figure"><img src="fig/support_acoustic_1.pdf" id="A5.F8.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <span class="ltx_ERROR undefined">\@slowromancap</span>ii@-<span class="ltx_ERROR undefined">\@slowromancap</span>iv@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</figcaption>
</figure>
<figure id="A5.F9" class="ltx_figure"><img src="fig/support_acoustic_2.pdf" id="A5.F9.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <span class="ltx_ERROR undefined">\@slowromancap</span>v@-<span class="ltx_ERROR undefined">\@slowromancap</span>vii@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</figcaption>
</figure>
<figure id="A5.F10" class="ltx_figure"><img src="fig/support_acoustic_3.pdf" id="A5.F10.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <span class="ltx_ERROR undefined">\@slowromancap</span>viii@-<span class="ltx_ERROR undefined">\@slowromancap</span>x@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</figcaption>
</figure>
<figure id="A5.F11" class="ltx_figure"><img src="fig/support_optical_1.pdf" id="A5.F11.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Designs and corresponding absorbance spectra of generated optical metasurface designs for design targets <span class="ltx_ERROR undefined">\@slowromancap</span>ii@-<span class="ltx_ERROR undefined">\@slowromancap</span>vi@ (marked as gray-shaded wavelength regions). Each row shows five designs with the highest likelihood of satisfying a target (left panel) and their absorbance spectra (right panel).
</figcaption>
</figure>
<figure id="A5.F12" class="ltx_figure"><img src="fig/support_optical_2.pdf" id="A5.F12.g1" class="ltx_graphics ltx_centering" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Designs and corresponding absorbance spectra of generated optical metasurface designs for design targets <span class="ltx_ERROR undefined">\@slowromancap</span>vii@-<span class="ltx_ERROR undefined">\@slowromancap</span>x@ (marked as gray-shaded wavelength regions). Each row shows five designs with the highest likelihood of satisfying a target (left panel) and their absorbance spectra (right panel).
</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Apr 23 13:49:44 2024 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>
</body>
</html>
