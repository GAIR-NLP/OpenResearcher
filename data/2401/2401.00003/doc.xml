<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/opt/latexml,/home/data/tmp/tmp/2401.00003"?>
<?latexml class="article"?>
<?latexml package="arxiv"?>
<?latexml package="inputenc" options="utf8"?>
<?latexml package="fontenc" options="T1"?>
<?latexml package="hyperref"?>
<?latexml package="url"?>
<?latexml package="booktabs"?>
<?latexml package="amsfonts"?>
<?latexml package="nicefrac"?>
<?latexml package="microtype"?>
<?latexml package="lipsum"?>
<?latexml package="graphicx"?>
<?latexml graphicspath="/home/data/tmp/tmp/2401.00003/images"?>
<?latexml package="amsmath"?>
<?latexml package="multirow"?>
<?latexml package="makecell"?>
<?latexml package="float"?>
<?latexml package="appendix" options="toc,page"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title><!--  %\title{RIGID:␣Random-forest-based␣Interpretable␣Generative␣Inverse␣Design␣of␣Wave-based␣Metamaterials} -->Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning<!--  %\title{Meeting␣Target␣Spectral␣Ranges␣with␣Interpretable␣Generative␣Inverse␣Design} 
     %\title{Interpretable␣Generative␣Inverse␣Design␣of␣Wave-Based␣Metamaterials␣with␣Small␣Data} 
     %\title{Tailoring␣Qualitative␣Behaviors␣of␣Wave-Based␣Metamaterials␣with␣Small␣Data} 
     %\title{Generating␣Wave-Based␣Metamaterials␣with␣Tailored␣Qualitative␣Behaviors␣Using␣Small␣Data} 
     %\title{Generative␣Inverse␣Design␣of␣Wave-Based␣Metamaterials␣with␣Interpretable␣Machine␣Learning␣and␣Small␣Data} 
     %\title{Generative␣Inverse␣Design␣of␣Optical␣and␣Acoustic␣Metamaterials␣with␣Interpretable␣Machine␣Learning} --></title>
  <creator role="author">
    <personname>
Wei (Wayne) Chen <break/>J. Mike Walker ’66 Department of Mechanical Engineering<break/>Texas A&amp;M University<break/>College Station, TX 77843 <break/><text font="typewriter">w.chen@tamu.edu</text> <break/><!--  %%␣examples␣of␣more␣authors -->&amp;Rachel Sun <break/>Department of Mechanical Engineering<break/><!--  %****␣main.tex␣Line␣50␣**** -->Massachusetts Institute of Technology<break/>Cambridge, MA 02139 <break/><text font="typewriter">rmsun@mit.edu</text> <break/>&amp;Doksoo Lee <break/>Department of Mechanical Engineering<break/>Northwestern University<break/>Evanston, IL 60208 <break/><text font="typewriter">dslee@northwestern.edu</text> <break/>&amp;Carlos M. Portela <break/>Department of Mechanical Engineering<break/>Massachusetts Institute of Technology<break/>Cambridge, MA 02139 <break/><text font="typewriter">cportela@mit.edu</text> <break/>&amp;Wei Chen <break/>Department of Mechanical Engineering<break/>Northwestern University<break/>Evanston, IL 60208 <break/><text font="typewriter">weichen@northwestern.edu</text> <break/><!--  %%␣\AND 
     %%␣Coauthor␣\\ 
     %%␣Affiliation␣\\ 
     %%␣Address␣\\ 
     %****␣main.tex␣Line␣75␣**** 
     %%␣\texttt{email}␣\\ 
     %%␣\And 
     %%␣Coauthor␣\\ 
     %%␣Affiliation␣\\ 
     %%␣Address␣\\ 
     %%␣\texttt{email}␣\\ 
     %%␣\And 
     %%␣Coauthor␣\\ 
     %%␣Affiliation␣\\ 
     %%␣Address␣\\ 
     %%␣\texttt{email}␣\\ --></personname>
  </creator>
  <abstract name="Abstract">
    <p>Metamaterials with functional responses, such as wave-based responses or deformation-induced property variation under external stimuli, can exhibit varying properties or functionalities under different conditions. Herein, we aim at rapid inverse design of these metamaterials to meet target qualitative functional behaviors. This inverse problem is challenging due to its intractability and the existence of non-unique solutions. Past works mainly focus on deep-learning-based methods that are data-demanding, require time-consuming training and hyperparameter tuning, and are non-interpretable. To overcome these limitations, we propose the Random-forest-based Interpretable Generative Inverse Design (RIGID), a single-shot inverse design method to achieve the fast generation of metamaterial designs with on-demand functional behaviors. Unlike most existing methods, by exploiting the interpretability of the random forest, we eliminate the need to train an inverse model mapping responses to designs. Based on the likelihood of target satisfaction derived from the trained forward model, one can sample design solutions using Markov chain Monte Carlo methods. The RIGID method therefore functions as a generative model that captures the conditional distribution of satisfying solutions given a design target. We demonstrate the effectiveness and efficiency of RIGID on both acoustic and optical metamaterial design problems where only small datasets (less than 250 training samples) are available. Synthetic design problems are created to further illustrate and validate the mechanism of likelihood estimation in RIGID. This work offers a new perspective on solving on-demand inverse design problems, showcasing the potential for incorporating interpretable machine learning into generative design and eliminating its large data requirement.</p>
  </abstract>
<!--  %keywords␣can␣be␣removed 
     %\keywords{First␣keyword␣\and␣Second␣keyword␣\and␣More} -->  <section inlist="toc" labels="LABEL:sec:introduction" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>Metamaterials with functional responses are engineered materials that exhibit varying properties or behaviors under different conditions. One example is metamaterials whose electromagnetic, acoustic, or elastic wave propagation behaviors change with wavelengths or frequencies <cite class="ltx_citemacro_cite">[<bibref bibrefs="jiang2022flexible" separator="," yyseparator=","/>]</cite>. Another example is metamaterials that exhibit changing properties or functionalities due to deformation in response to external stimuli like temperature <cite class="ltx_citemacro_cite">[<bibref bibrefs="boley2019shape" separator="," yyseparator=","/>]</cite> and magnetic fields <cite class="ltx_citemacro_cite">[<bibref bibrefs="ma2022deep" separator="," yyseparator=","/>]</cite>.
Tailoring functional responses of these metamaterials is of interest to applications such as sound and vibration control, analog computing, medical imaging, sensing, communication, and soft robotics. In many use cases, rather than precisely controlling the complete functional responses, we only care about <text font="italic">qualitative</text> behaviors under certain conditions. For example, acoustic metamaterials were usually designed to have bandgaps at specified frequencies to achieve functionalities like wave-guiding <cite class="ltx_citemacro_cite">[<bibref bibrefs="casadei_piezoelectric_2012,liu2020acoustic" separator="," yyseparator=","/>]</cite>, focusing <cite class="ltx_citemacro_cite">[<bibref bibrefs="kim2021poroelastic,xie2018acoustic" separator="," yyseparator=","/>]</cite>, and vibration mitigation <cite class="ltx_citemacro_cite">[<bibref bibrefs="matlack2016composite,krodel2015wide,bayat2018wave" separator="," yyseparator=","/>]</cite>. However, it is unnecessary and computationally expensive to design for the whole dispersion relation <cite class="ltx_citemacro_cite">[<bibref bibrefs="ronellenfitsch2019inverse,goh2020inverse,li2020designing,zhang2021realization,chen2022see" separator="," yyseparator=","/>]</cite>. Similarly, we may design optical metamaterials to qualitatively manipulate optical properties (e.g., high or low absorption/reflection/transmission) under certain wavelengths, without requiring the entire spectral response to match an exact target <cite class="ltx_citemacro_cite">[<bibref bibrefs="vismara2019solar,cheng2021plasmonic" separator="," yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Identifying metamaterial designs from a given target forms an inverse design problem. Unlike many forward problems where one can obtain solutions (e.g., spectral responses or material properties under external stimuli) by modeling the physics or conducting experiments, inverse design problems are usually intractable. Traditionally, these problems are solved by iterative optimization (i.e., minimizing the difference between the actual quantity of interest and the target) <cite class="ltx_citemacro_cite">[<bibref bibrefs="ronellenfitsch2019inverse,goh2020inverse,zhang2021realization" separator="," yyseparator=","/>]</cite>. This, however, requires repeatedly updating the design solution and solving forward problems. When the design target changes, one needs to rerun the entire optimization process. Thus, inverse design by iterative optimization becomes impractical if solving the forward problem (by simulations or experiments) is time-consuming or if the design target needs to change frequently. To accelerate the optimization approach, prior works replaced simulations or experiments with machine learning models <cite class="ltx_citemacro_cite">[<bibref bibrefs="inampudi2018neural,zhelyeznyakov2021deep" separator="," yyseparator=","/>]</cite>. However, the efficiency and quality of final solutions are highly dependent on both the machine learning model and the optimization algorithm. On the other hand, a single run of optimization usually only returns one final solution, although multiple designs might satisfy a given target (i.e., the <text font="italic">non-uniqueness</text> of solutions). For example, multiple acoustic metamaterial designs may have bandgaps within the same target frequency range. This non-uniqueness nature of inverse design problems was also shown for optical metasurfaces <cite class="ltx_citemacro_cite">[<bibref bibrefs="liu2018training,ma2019probabilistic,An2021MultifunctionalNetwork" separator="," yyseparator=","/>]</cite>. The optimization approach eliminates the opportunity to explore diverse alternative solutions.</p>
    </para>
    <para xml:id="S1.p3">
      <p>To avoid iterative optimization and enable fast on-demand inverse design, prior research attempted to realize single-shot (iteration-free) inverse design using machine learning. There are three mainstream models (their schematic diagrams are shown in <text font="italic">Appendix, Fig. <ref labelref="LABEL:fig:support_past_work"/></text>). The most straightforward approach is to learn a <text font="italic">direct inverse mapping</text> from the response to design variables. Neural networks are the most commonly used machine learning model for this purpose, due to their high flexibility in approximating arbitrary nonlinear input-output relationships <cite class="ltx_citemacro_cite">[<bibref bibrefs="Malkiel2018PlasmonicLearning,li2020designing" separator="," yyseparator=","/>]</cite>. Despite the simplicity of the direct inverse mapping, its underlying assumption of the response-design mapping being one-to-one does not hold in many cases due to the non-uniqueness of solutions, as mentioned earlier. Such non-uniqueness will cause conflicting training instances where the same input (response) is associated with distinct outputs (designs), which will destabilize the convergence during neural network training <cite class="ltx_citemacro_cite">[<bibref bibrefs="liu2018training,lee2023data" separator="," yyseparator=","/>]</cite>. To avoid this issue, past work proposed the <text font="italic">Tandem Neural Network (T-NN)</text> that cascades an inverse-design network with a forward-modeling network <cite class="ltx_citemacro_cite">[<bibref bibrefs="liu2018training,an2019deep,kumar2020inverse,Yeung2021MultiplexedNetworks,bastek2022inverting" separator="," yyseparator=","/>]</cite>. Its training is split into two steps: (1) pretraining the forward-modeling network to approximate the design-response mapping and (2) training the cascaded network by freezing the weights of the pretrained forward-modeling network. There is no loss function that forces designs at the intermediate layer to match data (which contains conflicting instances), hence the training convergence issue is avoided. Nonetheless, the original T-NNs still learn a one-to-one response-design mapping and cannot account for the non-uniqueness of design solutions. To fundamentally solve this problem, one needs to learn a one-to-many mapping. Bastek et al. <cite class="ltx_citemacro_cite">[<bibref bibrefs="bastek2022inverting" separator="," yyseparator=","/>]</cite> integrated stochastic sampling into the inverse-design network to allow the generation of multiple feasible solutions. A large body of recent works achieved the goal of learning one-to-many mapping by using <text font="italic">conditional generative models</text>, typically conditional generative adversarial networks (cGANs) <cite class="ltx_citemacro_cite">[<bibref bibrefs="jiang2019free,so2019designing,wen2020robust,gurbuz2021generative,An2021MultifunctionalNetwork" separator="," yyseparator=","/>]</cite>, conditional variational autoencoders (cVAEs) <cite class="ltx_citemacro_cite">[<bibref bibrefs="ma2019probabilistic" separator="," yyseparator=","/>]</cite>, and conditional diffusion models <cite class="ltx_citemacro_cite">[<bibref bibrefs="lew2023single" separator="," yyseparator=","/>]</cite>. These models can generate multiple designs given a target response by learning the distribution of designs conditioned on the response. Different generative models have distinct ways of learning conditional distributions. In general, this is realized by training neural networks to transform responses and random noise (or latent variables) into designs, so that the trained network can generate a non-deterministic design solution from a given target response and randomly sampled noise, which is equivalent to sampling from a conditional distribution.</p>
    </para>
    <para xml:id="S1.p4">
      <p>Although conditional generative models have demonstrated success in solving inverse design problems, they still have issues, such as high data demand, exhaustive hyperparameter tuning, slow training, and low interpretability, especially compared to traditional machine learning models like decision trees and random forests. On the other hand, Elzouka et al. <cite class="ltx_citemacro_cite">[<bibref bibrefs="elzouka2020interpretable" separator="," yyseparator=","/>]</cite> proposed to use the decision tree as a more interpretable model to solve both the forward prediction and inverse design problem. After training a decision tree for forward prediction, one can identify explicit design rules (i.e., feasible regions in the design space) by tracing from target leaf nodes to the root node. This approach also captures the one-to-many mapping nature of inverse design problems since it gives feasible design variable ranges rather than a single solution. However, there remain some limitations. Firstly, for solutions identified by the design rules, the method does not differentiate their likelihood of target satisfaction. Yet in reality, solutions always have different likelihoods due to the uncertainty of model estimation. Secondly, the method has to train two models: a random forest was trained first to ensure model accuracy and robustness, and then a large decision tree was trained to emulate the performance of the random forest and provide design rules. This is due to the challenge of deriving explicit design rules from an ensemble model like the random forest. Finally, the method was demonstrated on a problem with more than <Math mode="inline" tex="10^{4}" text="10 ^ 4" xml:id="S1.p4.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
              <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
            </XMApp>
          </XMath>
        </Math> training data, while the effectiveness on smaller datasets (i.e., data with orders of magnitude smaller sample sizes) was not studied.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:overview" placement="h" xml:id="S1.F1">
      <tags>
        <tag>Figure 1</tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <graphics candidates="fig/overview.pdf" class="ltx_centering" graphic="fig/overview.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S1.F1.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>Schematic diagram of the RIGID method. We first train a random forest on a design-response dataset to learn the forward design-response relation — predicting qualitative responses (e.g., bandgap existence at any given wave frequency) of designs. Then given a design target, we can infer the likelihood of any design satisfying the target by probing into the trained random forest. New designs with tailored responses can be generated by sampling the design space based on the likelihood estimation.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 1</tag>Schematic diagram of the RIGID method. We first train a random forest on a design-response dataset to learn the forward design-response relation — predicting qualitative responses (e.g., bandgap existence at any given wave frequency) of designs. Then given a design target, we can infer the likelihood of any design satisfying the target by probing into the trained random forest. New designs with tailored responses can be generated by sampling the design space based on the likelihood estimation.</caption>
    </figure>
    <para xml:id="S1.p5">
      <p>This work aims to address the aforementioned problems by proposing a method called <text font="italic">Random-forest-based Interpretable Generative Inverse Design (RIGID)</text>.
Figure <ref labelref="LABEL:fig:overview"/> shows an overview of this method. Specifically, we first train a forward prediction random forest. Then given a design target, we can probe the trained random forest to infer the likelihood of any design satisfying the target. To generate new designs tailored to the target, we can sample from the design space according to the likelihood. Compared to the most widely studied neural-network-based methods, RIGID has a much lower cost in training and hyperparameter tuning, and works more robustly on small-size datasets (as random forests are less prone to overfitting). Similar to deep generative models, it can generate a desired number of solutions, allowing one to explore alternative solutions that might have desired properties or functionalities beyond the ones considered as the target. The explicit likelihood estimation also offers an interpretable characterization of a design’s target satisfaction probability and allows an exploitation-exploration trade-off when selecting generated designs. We validate the RIGID method on two metamaterial design examples — an acoustic metamaterial design example, where the target is to generate metamaterials with specific bandgaps, and an optical metasurface design example, where the target is to generate metasurfaces with high absorbance at specified wavelengths.</p>
    </para>
    <para xml:id="S1.p6">
      <p>Our contributions are three-fold. First, we propose a single-shot inverse design method that is fast, generative, interpretable, and small-data-compatible. Secondly, we demonstrate the effectiveness of the proposed method on acoustic and optical metamaterial design examples, and propose both qualitative and quantitative ways of assessing our method. Finally, we create two synthetic test cases for fast examination and validation of model performance. These test cases can be used for future benchmarking studies of related methods.</p>
    </para>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %\section{Related␣Work} 
     %****␣main.tex␣Line␣125␣**** 
     %\label{sec:related_work} 
     %\subsection{Inverse␣Design␣via␣Iterative␣Optimization} 
     %\subsection{One-Shot␣Inverse␣Design} -->  </section>
  <section inlist="toc" labels="LABEL:sec:methodology" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Methods</title>
    <para xml:id="S2.p1">
      <p>The functional response of metamaterials can be modeled as <Math mode="inline" tex="y=f(\mathbf{x},s)" text="y = f * open-interval@(x, s)" xml:id="S2.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.p1.m1.1"/>
                    <XMRef idref="S2.p1.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="bold" role="UNKNOWN" xml:id="S2.p1.m1.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m1.2">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, where <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.p1.m2">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> denotes metamaterial design variables (e.g., materials and geometry parameters), <Math mode="inline" tex="s" text="s" xml:id="S2.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> is an <text font="italic">auxiliary variable</text> representing the independent variable (or the “<Math mode="inline" tex="x" text="x" xml:id="S2.p1.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>-axis”) of the response (e.g., the frequency/wavelength or the external stimuli such as temperature), and <Math mode="inline" tex="y" text="y" xml:id="S2.p1.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> indicates the value of the response associated with our design target. In this paper, we assume <Math mode="inline" tex="y\in\{0,1\}" text="y element-of set@(0, 1)" xml:id="S2.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="S2.p1.m6.1"/>
                  <XMRef idref="S2.p1.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m6.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S2.p1.m6.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> since we only focus on qualitative behaviors at specified frequencies (e.g., for an acoustic metamaterial or an optical metamaterial design, whether a bandgap exists or whether the energy absorbance is higher than a threshold within a range of frequencies). We leave the more challenging problem of tailoring quantitative behaviors as future work.</p>
    </para>
    <para xml:id="S2.p2">
      <p>We use a random forest to approximate the function <Math mode="inline" tex="f" text="f" xml:id="S2.p2.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">f</XMTok>
          </XMath>
        </Math>. A random forest is an ensemble learning method that combines the predictions of multiple decision trees to improve accuracy and reduce overfitting <cite class="ltx_citemacro_cite">[<bibref bibrefs="breiman2001random" separator="," yyseparator=","/>]</cite>. The trained random forest serves as a <text font="italic">forward prediction</text> model that predicts the outcome <Math mode="inline" tex="y" text="y" xml:id="S2.p2.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> given design variables <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.p2.m3">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> and the auxiliary variable <Math mode="inline" tex="s" text="s" xml:id="S2.p2.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math>. Compared to the widely used neural networks, the random forest as a forward prediction model offers (1) significantly faster training, (2) less hyperparameters to tune, (3) less susceptible to overfitting on small data, and (4) interpretability (i.e., the decision-making of each tree in the random forest is transparent). More importantly, this interpretability also allows us to realize <text font="italic">inverse design</text> without training a separate inverse model.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:rigid" placement="h" xml:id="S2.F2">
      <tags>
        <tag>Figure 2</tag>
        <tag role="autoref">Figure 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <graphics candidates="fig/rigid.pdf" class="ltx_centering" graphic="fig/rigid.pdf" options="width=390.25534pt,keepaspectratio=true" xml:id="S2.F2.g1"/>
      <toccaption class="ltx_centering"><tag close=" "><!--  %****␣main.tex␣Line␣150␣**** -->2<!--  %****␣main.tex␣Line␣150␣**** 
     %****␣main.tex␣Line␣150␣**** 
     %****␣main.tex␣Line␣150␣**** 
     %****␣main.tex␣Line␣150␣**** 
     %****␣main.tex␣Line␣150␣**** --></tag><!--  %****␣main.tex␣Line␣150␣**** -->The inverse design pipeline of the proposed RIGID method (using the inverse design of acoustic metamaterials as an example). Given design parameters <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.F2.m1">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> and the auxiliary variable <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> (e.g., wave frequency), a trained random forest predicts the probability of the qualitative response <Math mode="inline" tex="y" text="y" xml:id="S2.F2.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> (e.g., bandgap existence). Each tree in the random forest splits the joint space of <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.F2.m4">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> into regions, each associated with a specific prediction (shown on leaf nodes). The splitting criteria are encoded in tree nodes. “T” means meeting a criterion and “F” means not meeting it. RIGID first identifies leaf nodes that are relevant to the considered range of auxiliary variable <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m6">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> by checking splitting criteria related to <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> and pruning tree branches that are irrelevant (Step 1). If the considered range of <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> has multiple parts, we repeat this step for each part and take the intersection of relevant leaves (Step 2). Each relevant leaf node corresponds to a decision path indicating a region in the design space, as well as a predicted probability of target satisfaction, which is a score we assign to the corresponding design space region (Step 3). With multiple trees in a random forest, we can average the scores predicted by each tree and use the average score as our likelihood estimation (Step 4). We can then sample from the design space based on the likelihood distribution to generate new designs tailored to the target (Step 5).</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 2</tag><!--  %****␣main.tex␣Line␣150␣**** 
     %****␣main.tex␣Line␣150␣**** -->The inverse design pipeline of the proposed RIGID method (using the inverse design of acoustic metamaterials as an example). Given design parameters <!--  %****␣main.tex␣Line␣150␣**** 
     %****␣main.tex␣Line␣150␣**** --><Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.F2.m9">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> and the auxiliary variable <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m10">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> (e.g., wave frequency), a trained random forest predicts the probability of the qualitative response <Math mode="inline" tex="y" text="y" xml:id="S2.F2.m11">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> (e.g., bandgap existence). Each tree in the random forest splits the joint space of <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.F2.m12">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m13">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> into regions, each associated with a specific prediction (shown on leaf nodes). The splitting criteria are encoded in tree nodes. “T” means meeting a criterion and “F” means not meeting it. RIGID first identifies leaf nodes that are relevant to the considered range of auxiliary variable <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m14">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> by checking splitting criteria related to <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m15">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> and pruning tree branches that are irrelevant (Step 1). If the considered range of <Math mode="inline" tex="s" text="s" xml:id="S2.F2.m16">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> has multiple parts, we repeat this step for each part and take the intersection of relevant leaves (Step 2). Each relevant leaf node corresponds to a decision path indicating a region in the design space, as well as a predicted probability of target satisfaction, which is a score we assign to the corresponding design space region (Step 3). With multiple trees in a random forest, we can average the scores predicted by each tree and use the average score as our likelihood estimation (Step 4). We can then sample from the design space based on the likelihood distribution to generate new designs tailored to the target (Step 5).</caption>
    </figure>
    <para xml:id="S2.p3">
      <p>Figure <ref labelref="LABEL:fig:rigid"/> shows how, by probing the trained random forest, one can estimate a likelihood distribution for target satisfaction of solutions over the entire design space and sample (generate) new designs based on this likelihood distribution. Since we target qualitative (binary) behaviors at specified <Math mode="inline" tex="s" text="s" xml:id="S2.p3.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> (e.g., a bandgap in 3-4 MHz frequency or high absorption at a wavelength of 400-500 nm), we first identify the leaf nodes (on each decision tree in the random forest) that are relevant to the <Math mode="inline" tex="s" text="s" xml:id="S2.p3.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> in the target (Fig. <ref labelref="LABEL:fig:rigid"/>, Step 1). We do this by tracing down each tree, checking only the nodes that use <Math mode="inline" tex="s" text="s" xml:id="S2.p3.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> as the splitting feature, and pruning the branches that are irrelevant to the <Math mode="inline" tex="s" text="s" xml:id="S2.p3.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> in the target. For example, as shown in Fig. <ref labelref="LABEL:fig:rigid"/>, there are two tree nodes using <Math mode="inline" tex="s" text="s" xml:id="S2.p3.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> as the splitting feature, with splitting criteria at <Math mode="inline" tex="s\leq 5" text="s &lt;= 5" xml:id="S2.p3.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="s\leq 7" text="s &lt;= 7" xml:id="S2.p3.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="7" role="NUMBER">7</XMTok>
            </XMApp>
          </XMath>
        </Math>. Given the target frequency range of <Math mode="inline" tex="3\leq s\leq 4" text="3 &lt;= s &lt;= 4" xml:id="S2.p3.m8">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMTok meaning="3" role="NUMBER">3</XMTok>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok meaning="4" role="NUMBER">4</XMTok>
            </XMApp>
          </XMath>
        </Math>, we can remove the right branches of both nodes as these branches are only relevant to <Math mode="inline" tex="s&gt;5" text="s &gt; 5" xml:id="S2.p3.m9">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="s&gt;7" text="s &gt; 7" xml:id="S2.p3.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="7" role="NUMBER">7</XMTok>
            </XMApp>
          </XMath>
        </Math>, respectively, which conflicts with the target range of <Math mode="inline" tex="3\leq s\leq 4" text="3 &lt;= s &lt;= 4" xml:id="S2.p3.m11">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMTok meaning="3" role="NUMBER">3</XMTok>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok meaning="4" role="NUMBER">4</XMTok>
            </XMApp>
          </XMath>
        </Math>. After pruning these branches, we end up with a set of leaves relevant to the target (highlighted in Fig. <ref labelref="LABEL:fig:rigid"/>, Step 1). When we have a combined target (e.g., bandgaps in both 3-4 MHz and 6-7 MHz, as shown in Fig. <ref labelref="LABEL:fig:rigid"/>), we need to get the intersection of all the sets of relevant leaves and use that as the final set of relevant leaves (highlighted in Fig. <ref labelref="LABEL:fig:rigid"/>, Step 2). Note that a combined target includes cases where there are multiple nonadjacent target ranges (e.g., 3-4 MHz and 6-7 MHz) or when a target range is split by a tree node (e.g., a target range of 4-6 MHz can be split by the node “<Math mode="inline" tex="s\leq 5" text="s &lt;= 5" xml:id="S2.p3.m12">
          <XMath>
            <XMApp>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMApp>
          </XMath>
        </Math>”, thus we need to consider it as the combination of two target ranges — 4-5 MHz and 5-6 MHz). A more detailed discussion of this step is in <text font="italic">Appendix, Sec. <ref labelref="LABEL:sec:app_step2"/></text>.</p>
    </para>
    <para xml:id="S2.p4">
      <p>The next step is to trace up the tree from the <Math mode="inline" tex="N" text="N" xml:id="S2.p4.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">N</XMTok>
          </XMath>
        </Math> relevant leaves, obtained by Step 2, to the root node (Fig. <ref labelref="LABEL:fig:rigid"/>, Step 3). This will result in <Math mode="inline" tex="N" text="N" xml:id="S2.p4.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">N</XMTok>
          </XMath>
        </Math> decision paths, along which are nodes indicating splitting criteria for design variables <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.p4.m3">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>. Thus, each decision path represents a set of design variable ranges, or in other words, a region in the design space. We assign each region a score equal to the predicted probability at each corresponding leaf. This probability is learned from the training data and equals the proportion of positive data in a leaf. It indicates the tree’s belief in the probability of a design <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.p4.m4">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> satisfying the target <Math mode="inline" tex="\mathcal{T}" text="T" xml:id="S2.p4.m5">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
          </XMath>
        </Math> if the design falls in the design space region corresponding to the leaf. Therefore, with a single decision tree <Math mode="inline" tex="i" text="i" xml:id="S2.p4.m6">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">i</XMTok>
          </XMath>
        </Math>, we already have the map of likelihood <Math mode="inline" tex="\mathcal{L}_{m}(\mathbf{x}|\mathcal{T})=\mathbb{P}_{m}(\mathcal{T}|\mathbf{x})" text="L _ m * conditional@(x, T) = P _ m * conditional@(T, x)" xml:id="S2.p4.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S2.p4.m7.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.p4.m7.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="bold" role="UNKNOWN">x</XMTok>
                      <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">P</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S2.p4.m7.2"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.p4.m7.2">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                      <XMTok font="bold" role="UNKNOWN">x</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> for target satisfaction: each of the <Math mode="inline" tex="N" text="N" xml:id="S2.p4.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">N</XMTok>
          </XMath>
        </Math> regions has a uniformly distributed likelihood equal to the predicted probability at the corresponding leaf, and the rest of the design space has a likelihood of 0 (Fig. <ref labelref="LABEL:fig:rigid"/>, Step 3).</p>
    </para>
    <para xml:id="S2.p5">
      <p>Since a single decision tree usually lacks accuracy, robustness, and a way to quantify estimation uncertainty, we still want to take advantage of the random forest as an ensemble model for inverse design. We use Steps 1-3 to derive the likelihood distribution for each of the <Math mode="inline" tex="M" text="M" xml:id="S2.p5.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">M</XMTok>
          </XMath>
        </Math> trees in the random forest, and simply use the average of these <Math mode="inline" tex="M" text="M" xml:id="S2.p5.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">M</XMTok>
          </XMath>
        </Math> likelihood distributions as the final likelihood for target satisfaction, <Math mode="inline" tex="\mathcal{L}(\mathbf{x}|\mathcal{T})=\sum_{m}^{M}\mathcal{L}_{m}(\mathbf{x}|%&#10;\mathcal{T})/M" text="L * conditional@(x, T) = ((sum _ m) ^ M)@((L _ m * conditional@(x, T)) / M)" xml:id="S2.p5.m3">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                <XMDual>
                  <XMRef idref="S2.p5.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.p5.m3.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="bold" role="UNKNOWN">x</XMTok>
                      <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.p5.m3.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.p5.m3.2">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="bold" role="UNKNOWN">x</XMTok>
                          <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">M</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, which is a more complex and smooth function (Fig. <ref labelref="LABEL:fig:rigid"/>, Step 4). If more trees believe a design <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S2.p5.m4">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> has a higher likelihood of satisfying the target, then the design will have a higher likelihood <Math mode="inline" tex="\mathcal{L}(\mathbf{x}|\mathcal{T})" text="L * conditional@(x, T)" xml:id="S2.p5.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
              <XMDual>
                <XMRef idref="S2.p5.m5.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S2.p5.m5.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMTok font="bold" role="UNKNOWN">x</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. Finally, to generate new designs, we can sample from <Math mode="inline" tex="\mathcal{L}(\mathbf{x}|\mathcal{T})" text="L * conditional@(x, T)" xml:id="S2.p5.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
              <XMDual>
                <XMRef idref="S2.p5.m6.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S2.p5.m6.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMTok font="bold" role="UNKNOWN">x</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> using Markov chain Monte Carlo (MCMC) methods such as Metropolis-Hastings <cite class="ltx_citemacro_cite">[<bibref bibrefs="hastings1970monte" separator="," yyseparator=","/>]</cite> (Fig. <ref labelref="LABEL:fig:rigid"/>, Step 5).</p>
    </para>
    <para xml:id="S2.p6">
      <p>Compared to prior works, RIGID provides the following unique benefits:</p>
      <enumerate xml:id="S2.I1">
        <item xml:id="S2.I1.i1">
          <tags>
            <tag>1.</tag>
            <tag role="autoref">item 1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">item 1</tag>
          </tags>
          <para xml:id="S2.I1.i1.p1">
            <p>It is effective on small data problems as the random forest is less susceptible to overfitting.</p>
          </para>
        </item>
        <item xml:id="S2.I1.i2">
          <tags>
            <tag>2.</tag>
            <tag role="autoref">item 2</tag>
            <tag role="refnum">2</tag>
            <tag role="typerefnum">item 2</tag>
          </tags>
          <para xml:id="S2.I1.i2.p1">
            <p>The training is fast (in seconds of wall time) and does not require computationally-demanding hyperparameter tuning. Once the training is done, no further training or iterative optimization is required to generate designs for different targets.</p>
          </para>
        </item>
        <item xml:id="S2.I1.i3">
          <tags>
            <tag>3.</tag>
            <tag role="autoref">item 3</tag>
            <tag role="refnum">3</tag>
            <tag role="typerefnum">item 3</tag>
          </tags>
          <para xml:id="S2.I1.i3.p1">
            <p>The model is interpretable as one can easily probe the trained model to understand its reasoning behind any decision-making.</p>
          </para>
        </item>
        <item xml:id="S2.I1.i4">
          <tags>
            <tag>4.</tag>
            <tag role="autoref">item 4</tag>
            <tag role="refnum">4</tag>
            <tag role="typerefnum">item 4</tag>
          </tags>
          <para xml:id="S2.I1.i4.p1">
            <p>It estimates the explicit likelihood of target satisfaction for every possible solution in the design space. Given a design target of specific functional behavior, we can generate an unlimited number of solutions based on the likelihood, allowing us to explore alternative solutions that might have desired properties or functionalities beyond the ones considered as the target.</p>
          </para>
        </item>
        <item xml:id="S2.I1.i5">
          <tags>
            <tag>5.</tag>
            <tag role="autoref">item 5</tag>
            <tag role="refnum">5</tag>
            <tag role="typerefnum">item 5</tag>
          </tags>
          <para xml:id="S2.I1.i5.p1">
            <p>When generating design solutions, one can use a single parameter — the sampling threshold — to easily tune the trade-off between exploitation (i.e., generated designs have higher chances of satisfying the target) and exploration (i.e., generated designs cover a broader area of the design space), as we will demonstrate in Results.</p>
          </para>
        </item>
      </enumerate>
    </para>
  </section>
  <section inlist="toc" labels="LABEL:sec:results" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Results</title>
    <para xml:id="S3.p1">
      <p>We demonstrate our RIGID method on an acoustic metamaterial design problem, an optical metasurface design problem, and two synthetic design problems. Based on a recent review article by Lee et al. <cite class="ltx_citemacro_cite">[<bibref bibrefs="lee2023data" separator="," yyseparator=","/>]</cite> and other related works (e.g., <cite class="ltx_citemacro_cite">[<bibref bibrefs="bastek2022inverting" separator="," yyseparator=","/>]</cite>), existing single-shot inverse design methods were demonstrated on training data size ranging from <Math mode="inline" tex="10^{3}" text="10 ^ 3" xml:id="S3.p1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
              <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
            </XMApp>
          </XMath>
        </Math> to <Math mode="inline" tex="10^{6}" text="10 ^ 6" xml:id="S3.p1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
              <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
            </XMApp>
          </XMath>
        </Math> in scale. Here we show that our method can work with much smaller-scale datasets (less than 250 training samples).</p>
    </para>
    <para xml:id="S3.p2">
      <p>For all the test problems, we used the same random forest hyperparameter settings and did not perform hyperparameter tuning. Specifically, each random forest contains 1,000 trees with a minimum of 2 samples required to split an internal node and a minimum of 1 sample required to be at a leaf node. Gini impurity <cite class="ltx_citemacro_cite">[<bibref bibrefs="BreiFrieStonOlsh84" separator="," yyseparator=","/>]</cite> was used as the splitting criterion at tree nodes.
The train-test split ratio was 4:1. Since the positive/negative training data can be highly imbalanced (e.g., the frequency ranges with bandgaps are much narrower than those without), we used the Synthetic Minority Over-sampling TEchnique (SMOTE) <cite class="ltx_citemacro_cite">[<bibref bibrefs="chawla2002smote" separator="," yyseparator=","/>]</cite> to over-sample the positive class. For all the case studies, the random forest training took less than 10 seconds on an Intel Core i5-9300H CPU 2.4GHz and 8GB memory.</p>
    </para>
    <para xml:id="S3.p3">
      <p>After training, we generate new designs by sampling from the resulting likelihood distribution using Metropolis-Hastings. In practice, Metropolis-Hastings can generate identical samples, which provides no benefits for design purposes. Thus in this work, we reject the designs identical to previous ones during sampling.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:acoustic" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps</title>
      <para xml:id="S3.SS1.p1">
        <p>Here we consider acoustic metamaterials that can control elastic wave propagation at ultrasound (MHz) frequencies. Varying the microscale geometries of acoustic metamaterials changes the dynamic properties of a material, such as bandgaps <cite class="ltx_citemacro_cite">[<bibref bibrefs="bayat2018wave" separator="," yyseparator=","/>]</cite> (i.e., forbidden frequency ranges of a material) and wave propagation direction <cite class="ltx_citemacro_cite">[<bibref bibrefs="casadei_piezoelectric_2012" separator="," yyseparator=","/>]</cite>.
These materials promise applications in waveguides <cite class="ltx_citemacro_cite">[<bibref bibrefs="casadei_piezoelectric_2012,liu2020acoustic" separator="," yyseparator=","/>]</cite>, lenses <cite class="ltx_citemacro_cite">[<bibref bibrefs="kim2021poroelastic,xie2018acoustic" separator="," yyseparator=","/>]</cite>, and vibration mitigation <cite class="ltx_citemacro_cite">[<bibref bibrefs="krodel2015wide" separator="," yyseparator=","/>]</cite>.
We present the braced cubic design framework (Fig. <ref labelref="LABEL:fig:acoustic"/>A-B) as a method to tune the size and location of bandgaps (Fig. <ref labelref="LABEL:fig:acoustic"/>C).
In particular, spherical micro-inertia are added to the center and corner of a braced cubic unit cell with strut radius <Math mode="inline" tex="r_{\text{strut}}" text="r _ [strut]" xml:id="S3.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">strut</text></XMText>
              </XMApp>
            </XMath>
          </Math>.
Micro-inertia placed at the center of the brace has radius <Math mode="inline" tex="r_{\text{center}}" text="r _ [center]" xml:id="S3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">center</text></XMText>
              </XMApp>
            </XMath>
          </Math> while micro-inertia placed at the corner of the cubic unit cell has radius <Math mode="inline" tex="r_{\text{corner}}" text="r _ [corner]" xml:id="S3.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">corner</text></XMText>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:acoustic" placement="h" xml:id="S3.F3">
        <tags>
          <tag>Figure 3</tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <graphics candidates="fig/acoustic.pdf" class="ltx_centering" graphic="fig/acoustic.pdf" options="width=346.89731pt,keepaspectratio=true" xml:id="S3.F3.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>Acoustic metamaterial design problem configuration and results. (A) Design variables of center and corner mass radii (<Math mode="inline" tex="r_{\text{center}}" text="r _ [center]" xml:id="S3.F3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">center</text></XMText>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="r_{\text{corner}}" text="r _ [corner]" xml:id="S3.F3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">corner</text></XMText>
              </XMApp>
            </XMath>
          </Math>) and strut radius (<Math mode="inline" tex="r_{\text{strut}}" text="r _ [strut]" xml:id="S3.F3.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">strut</text></XMText>
              </XMApp>
            </XMath>
          </Math>). (B) High symmetry points of the cubic irreducible Brillouin zone. (C) A sample dispersion relation and bandgap (marked by the highlighted zone). The design objective is to generate new acoustic metamaterial designs with target bandgaps. (D) KDE of the estimated likelihood for generated designs. (E) Validation metrics under varying sampling thresholds. (F) Geometries and corresponding dispersion relations of five generated designs with the highest likelihood of satisfying a specified target bandgap (marked as highlighted frequency regions). Here only the fourth design fails to meet a small portion (at around 6 MHz) of the target bandgap, whereas the others meet it. Generated designs for other targets are shown in <text font="italic">Appendix, Figs. <ref labelref="LABEL:fig:support_acoustic_1"/>-<ref labelref="LABEL:fig:support_acoustic_3"/></text>.
</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 3</tag>Acoustic metamaterial design problem configuration and results. (A) Design variables of center and corner mass radii (<Math mode="inline" tex="r_{\text{center}}" text="r _ [center]" xml:id="S3.F3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">center</text></XMText>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="r_{\text{corner}}" text="r _ [corner]" xml:id="S3.F3.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">corner</text></XMText>
              </XMApp>
            </XMath>
          </Math>) and strut radius (<Math mode="inline" tex="r_{\text{strut}}" text="r _ [strut]" xml:id="S3.F3.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMText><text fontsize="70%">strut</text></XMText>
              </XMApp>
            </XMath>
          </Math>). (B) High symmetry points of the cubic irreducible Brillouin zone. (C) A sample dispersion relation and bandgap (marked by the highlighted zone). The design objective is to generate new acoustic metamaterial designs with target bandgaps. (D) KDE of the estimated likelihood for generated designs. (E) Validation metrics under varying sampling thresholds. (F) Geometries and corresponding dispersion relations of five generated designs with the highest likelihood of satisfying a specified target bandgap (marked as highlighted frequency regions). Here only the fourth design fails to meet a small portion (at around 6 MHz) of the target bandgap, whereas the others meet it. Generated designs for other targets are shown in <text font="italic">Appendix, Figs. <ref labelref="LABEL:fig:support_acoustic_1"/>-<ref labelref="LABEL:fig:support_acoustic_3"/></text>.
</caption>
      </figure>
      <para xml:id="S3.SS1.p2">
        <p><!--  %ACOUSTIC␣METHOD␣(MOVE␣TO␣CORRECT␣SECTION) -->We randomly created 284 sets of geometric parameters <!--  %****␣main.tex␣Line␣200␣**** --><Math mode="inline" tex="\mathbf{x}=(r_{\text{strut}},r_{\text{center}},r_{\text{corner}})" text="x = vector@(r _ [strut], r _ [center], r _ [corner])" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="bold" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="S3.SS1.p2.m1.1"/>
                    <XMRef idref="S3.SS1.p2.m1.2"/>
                    <XMRef idref="S3.SS1.p2.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS1.p2.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMText><text fontsize="70%">strut</text></XMText>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p2.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMText><text fontsize="70%">center</text></XMText>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p2.m1.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMText><text fontsize="70%">corner</text></XMText>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> with 4 <Math mode="inline" tex="\leq r_{\text{strut}}\leq" text="absent &lt;= r _ [strut] &lt;= absent" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="absent"/>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMText><text fontsize="70%">strut</text></XMText>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok meaning="absent"/>
              </XMApp>
            </XMath>
          </Math> 6.41, 0 <Math mode="inline" tex="\leq r_{\text{center}}\leq" text="absent &lt;= r _ [center] &lt;= absent" xml:id="S3.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="absent"/>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMText><text fontsize="70%">center</text></XMText>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok meaning="absent"/>
              </XMApp>
            </XMath>
          </Math> 20, and 0 <Math mode="inline" tex="\leq r_{\text{corner}}\leq" text="absent &lt;= r _ [corner] &lt;= absent" xml:id="S3.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="absent"/>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMText><text fontsize="70%">corner</text></XMText>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok meaning="absent"/>
              </XMApp>
            </XMath>
          </Math> 20 (unit: µm). The unit cell size was set at <Math mode="inline" tex="a=60" text="a = 60" xml:id="S3.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok meaning="60" role="NUMBER">60</XMTok>
              </XMApp>
            </XMath>
          </Math> µm. For each of these designs, we performed Bloch-wave analysis to compute its acoustic dispersion relation.
Bandgap location and width were extracted for each design based on its dispersion relation.</p>
      </para>
      <para xml:id="S3.SS1.p3">
        <p>Out of the 284 sets of design variables and bandgap data, we used 227 samples as training data. We first discretized the entire frequency range into 100 intervals, and trained a random forest to predict bandgap existence <Math mode="inline" tex="y\in\{0,1\}" text="y element-of set@(0, 1)" xml:id="S3.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS1.p3.m1.1"/>
                    <XMRef idref="S3.SS1.p3.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.p3.m1.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS1.p3.m1.2">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> at a specific interval <Math mode="inline" tex="s" text="s" xml:id="S3.SS1.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> for a given design <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S3.SS1.p3.m3">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math>. The trained model has a test F1 score of 0.82. The resulting confusion matrix on test data is shown in <text font="italic">Appendix, Tab. <ref labelref="LABEL:tab:f1_acoustic"/></text>.</p>
      </para>
      <para xml:id="S3.SS1.p4">
        <p>To test the inverse design capability of RIGID, we randomly created 10 targets, each containing 1-2 frequency ranges in which bandgap(s) should exist.
We generated 30 designs for each target by sampling from the resulting likelihood distribution over the design space<note mark="1" role="footnote" xml:id="footnote1"><tags>
              <tag>1</tag>
              <tag role="autoref">footnote 1</tag>
              <tag role="refnum">1</tag>
              <tag role="typerefnum">footnote 1</tag>
            </tags>Note that it is possible for the likelihood to be zero everywhere in the design space when the model believes the target is unachievable. We ignore these cases as it is meaningless and impossible to sample designs from such likelihood distribution.</note>. Bandgaps were identified from dispersion relations computed using Bloch-wave analysis.
Figure <ref labelref="LABEL:fig:acoustic"/>D shows the kernel density estimation (KDE) for the likelihood of the 300 generated designs, conditioned on their target satisfaction.
We use <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S3.SS1.p4.m1">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="\mathcal{D}_{\text{feas}}" text="D _ [feas]" xml:id="S3.SS1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMText><text fontsize="70%">feas</text></XMText>
              </XMApp>
            </XMath>
          </Math> to represent the complete set of generated designs and the set of generated designs that actually satisfy the target, respectively. Then <Math mode="inline" tex="\mathcal{D}\backslash\mathcal{D}_{\text{feas}}" text="D backslash D _ [feas]" xml:id="S3.SS1.p4.m3">
            <XMath>
              <XMApp>
                <XMTok name="backslash" role="MULOP">\</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMText><text fontsize="70%">feas</text></XMText>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> denotes the set of generated designs that cannot fulfill the target in reality.
In an ideal scenario, all solutions in <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S3.SS1.p4.m4">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> would satisfy the target, which means <Math mode="inline" tex="\mathcal{D}=\mathcal{D}_{\text{feas}}" text="D = D _ [feas]" xml:id="S3.SS1.p4.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMText><text fontsize="70%">feas</text></XMText>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, and their density profiles should coincide. However, this ideal scenario is not possible due to limited model accuracy. Conveniently, the estimation of target satisfaction likelihood offers us an indicator of what solution is more likely to violate the target. For a reasonable model, most designs in <Math mode="inline" tex="\mathcal{D}\backslash\mathcal{D}_{\text{feas}}" text="D backslash D _ [feas]" xml:id="S3.SS1.p4.m6">
            <XMath>
              <XMApp>
                <XMTok name="backslash" role="MULOP">\</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMText><text fontsize="70%">feas</text></XMText>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> should have low estimated likelihood values. Consequently, the density of <Math mode="inline" tex="\mathcal{D}_{\text{feas}}" text="D _ [feas]" xml:id="S3.SS1.p4.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMText><text fontsize="70%">feas</text></XMText>
              </XMApp>
            </XMath>
          </Math>’s likelihood is a result of shifting some of <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S3.SS1.p4.m8">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>’s density from left (low likelihood) to right (high likelihood). This expectation aligns with the observation in Fig. <ref labelref="LABEL:fig:acoustic"/>D.</p>
      </para>
      <para xml:id="S3.SS1.p5">
        <p>When sampling new designs or selecting solutions from generated designs, we can put a <text font="italic">sampling threshold</text> <Math mode="inline" tex="\tau\in(0,1)" text="tau element-of open-interval@(0, 1)" xml:id="S3.SS1.p5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p5.m1.1"/>
                    <XMRef idref="S3.SS1.p5.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.p5.m1.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS1.p5.m1.2">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> on the likelihood values to filter out “less promising” solutions. To further examine model behavior and quantify how <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p5.m2">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> affects the inverse design outcome, we define the following metrics:</p>
        <equation labels="LABEL:eq:metrics" xml:id="S3.E1">
          <tags>
            <tag>(1)</tag>
            <tag role="autoref">Equation 1</tag>
            <tag role="refnum">1</tag>
          </tags>
          <Math mode="display" tex="\begin{split}\text{Selection Rate}&amp;=\frac{|\mathcal{D}_{\phi\geq\tau}|}{|%&#10;\mathcal{D}|},\\&#10;\text{Satisfaction Rate}&amp;=\frac{|\mathcal{D}_{\phi\geq\tau}\cap\mathcal{D}_{%&#10;\text{feas}}|}{|\mathcal{D}_{\phi\geq\tau}|},\\&#10;\text{Average Score}&amp;=\frac{1}{|\mathcal{D}_{\phi\geq\tau}|}\sum_{i=1}^{|%&#10;\mathcal{D}_{\phi\geq\tau}|}q_{i},\\&#10;\end{split}" text="formulae@([Selection Rate] = absolute-value@(D _ (phi &gt;= tau)) / absolute-value@(D), formulae@([Satisfaction Rate] = absolute-value@(D _ (phi &gt;= tau) intersection D _ [feas]) / absolute-value@(D _ (phi &gt;= tau)), [Average Score] = (1 / absolute-value@(D _ (phi &gt;= tau))) * ((sum _ (i = 1)) ^ (absolute-value@(D _ (phi &gt;= tau))))@(q _ i)))" xml:id="S3.E1.m1">
            <XMath>
              <XMDual>
                <XMDual>
                  <XMRef idref="S3.E1.m1.18"/>
                  <XMWrap>
                    <XMDual xml:id="S3.E1.m1.18">
                      <XMApp>
                        <XMTok meaning="formulae"/>
                        <XMRef idref="S3.E1.m1.18.1"/>
                        <XMRef idref="S3.E1.m1.18.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.E1.m1.18.1">
                          <XMRef idref="S3.E1.m1.2"/>
                          <XMRef idref="S3.E1.m1.1"/>
                          <XMRef idref="S3.E1.m1.3"/>
                        </XMApp>
                        <XMTok role="PUNCT"/>
                        <XMDual xml:id="S3.E1.m1.18.2">
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="S3.E1.m1.18.2.1"/>
                            <XMRef idref="S3.E1.m1.18.2.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E1.m1.18.2.1">
                              <XMRef idref="S3.E1.m1.6"/>
                              <XMRef idref="S3.E1.m1.5"/>
                              <XMRef idref="S3.E1.m1.7"/>
                            </XMApp>
                            <XMTok role="PUNCT"/>
                            <XMApp xml:id="S3.E1.m1.18.2.2">
                              <XMRef idref="S3.E1.m1.10"/>
                              <XMRef idref="S3.E1.m1.9"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMRef idref="S3.E1.m1.11"/>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                      <XMRef idref="S3.E1.m1.12"/>
                                      <XMRef idref="S3.E1.m1.13.1"/>
                                    </XMApp>
                                    <XMRef idref="S3.E1.m1.14.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E1.m1.15"/>
                                    <XMRef idref="S3.E1.m1.16.1"/>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="PUNCT"/>
                  </XMWrap>
                </XMDual>
                <XMArray colsep="0pt" name="aligned">
                  <XMRow>
                    <XMCell align="right">
                      <XMText xml:id="S3.E1.m1.1">Selection Rate</XMText>
                    </XMCell>
                    <XMCell align="left">
                      <XMWrap>
                        <XMApp xml:id="S3.E1.m1.19">
                          <XMTok meaning="equals" role="RELOP" xml:id="S3.E1.m1.2">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp xml:id="S3.E1.m1.3">
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="S3.E1.m1.3.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMApp xml:id="S3.E1.m1.3.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="S3.E1.m1.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E1.m1.3.2">D</XMTok>
                                <XMTok role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT" xml:id="S3.E1.m1.4">,</XMTok>
                      </XMWrap>
                    </XMCell>
                  </XMRow>
                  <XMRow>
                    <XMCell align="right">
                      <XMText xml:id="S3.E1.m1.5">Satisfaction Rate</XMText>
                    </XMCell>
                    <XMCell align="left">
                      <XMWrap>
                        <XMApp xml:id="S3.E1.m1.20">
                          <XMTok meaning="equals" role="RELOP" xml:id="S3.E1.m1.6">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp xml:id="S3.E1.m1.7">
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="S3.E1.m1.7.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMApp xml:id="S3.E1.m1.7.1">
                                  <XMTok meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                    <XMText><text fontsize="70%">feas</text></XMText>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="S3.E1.m1.7.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMApp xml:id="S3.E1.m1.7.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT" xml:id="S3.E1.m1.8">,</XMTok>
                      </XMWrap>
                    </XMCell>
                  </XMRow>
                  <XMRow>
                    <XMCell align="right">
                      <XMText xml:id="S3.E1.m1.9">Average Score</XMText>
                    </XMCell>
                    <XMCell align="left">
                      <XMWrap>
                        <XMApp xml:id="S3.E1.m1.21">
                          <XMTok meaning="equals" role="RELOP" xml:id="S3.E1.m1.10">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp xml:id="S3.E1.m1.11">
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="S3.E1.m1.11.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                                  <XMApp xml:id="S3.E1.m1.11.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E1.m1.12">∑</XMTok>
                                  <XMApp xml:id="S3.E1.m1.13.1">
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMDual xml:id="S3.E1.m1.14.1">
                                  <XMApp>
                                    <XMTok meaning="absolute-value"/>
                                    <XMRef idref="S3.E1.m1.14.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                                    <XMApp xml:id="S3.E1.m1.14.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                      <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="50%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="tau" role="UNKNOWN">τ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E1.m1.15">q</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E1.m1.16.1">i</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT" xml:id="S3.E1.m1.17">,</XMTok>
                      </XMWrap>
                    </XMCell>
                  </XMRow>
                </XMArray>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="\mathcal{D}_{\phi\geq\tau}" text="D _ (phi &gt;= tau)" xml:id="S3.SS1.p5.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                  <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                  <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is the set of generated designs with the likelihood of at least <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p5.m4">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> (i.e., the selected designs) and <Math mode="inline" tex="q_{i}" text="q _ i" xml:id="S3.SS1.p5.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> denotes the percentage overlap between the target and the actual behavior of selected designs.
The satisfaction rate evaluates how many selected designs satisfy the target based on a binary criterion (i.e., whether or not a design satisfies the complete target), whereas the average score provides a soft measure where partial satisfaction is also counted. The average score is lower-bounded by the satisfaction rate.</p>
      </para>
      <para xml:id="S3.SS1.p6">
        <p>As shown in Fig. <ref labelref="LABEL:fig:acoustic"/>E, the selection rate decreases when <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p6.m1">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> increases since more solutions are filtered out. On the other hand, both the satisfaction rate and the average score increase with <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p6.m2">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math>, which indicates a high correlation between the estimated likelihood of a solution and its probability of actually achieving the target. As <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p6.m3">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> reaches 0.6, the satisfaction rate and the average score reach 1, indicating that all generated designs satisfy their targets. When sampling or selecting new solutions, we can use the sample threshold <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p6.m4">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> to tune the trade-off between exploitation and exploration — a low <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p6.m5">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> favors exploration as sampled solutions will cover a larger area of the design space, while a high <Math mode="inline" tex="\tau" text="tau" xml:id="S3.SS1.p6.m6">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> favors exploitation as sampled solutions will have a higher chance of satisfying the target.</p>
      </para>
      <para xml:id="S3.SS1.p7">
        <p><!--  %****␣main.tex␣Line␣225␣**** -->Figure <ref labelref="LABEL:fig:acoustic"/><!--  %Although␣these␣designs␣exhibit␣different␣geometries␣and␣dispersion␣relations,␣most␣of␣them␣satisfy␣the␣target. -->F visualizes the geometries and dispersion relations of designs generated based on a randomly created bandgap target. Only the top five designs with the highest likelihood values are shown.
In this example, our method generates geometrically different designs that have a high probability of achieving target bandgaps, each yielding a slightly different dispersion relation. This is promising in design applications requiring other material properties, such as dynamic wave velocity or quasi-static stiffness, in which the user can select from a menu of designs with the same target bandgap but other varying properties. Generated designs based on the other nine bandgap targets can be found in <text font="italic">Appendix, Figs. <ref labelref="LABEL:fig:support_acoustic_1"/>-<ref labelref="LABEL:fig:support_acoustic_3"/></text>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:optical" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths</title>
      <para xml:id="S3.SS2.p1">
        <p>Optical metasurfaces are artificially engineered systems that can support exotic light propagation building on subwavelength inclusions <cite class="ltx_citemacro_cite">[<bibref bibrefs="pendry2000negative,yu2011light,kildishev2013planar,cui2014coding,bukhari2019metasurfaces,hu2021review" separator="," yyseparator=","/>]</cite>. Among a diverse array of devices, metamaterial absorbers <cite class="ltx_citemacro_cite">[<bibref bibrefs="landy2008perfect,liu2010infrared,hao2010high,watts2012metamaterial,cui2014plasmonic,liu2017experimental,lee2018complete" separator="," yyseparator=","/>]</cite> have been intensely studied for medical imaging, sensing, and wireless communications.</p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p>In this case study, we consider four types of cross-sections (<Math mode="inline" tex="c\in\{1,2,3,4\}" text="c element-of set@(1, 2, 3, 4)" xml:id="S3.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS2.p2.m1.1"/>
                    <XMRef idref="S3.SS2.p2.m1.2"/>
                    <XMRef idref="S3.SS2.p2.m1.3"/>
                    <XMRef idref="S3.SS2.p2.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS2.p2.m1.1">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="2" role="NUMBER" xml:id="S3.SS2.p2.m1.2">2</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="3" role="NUMBER" xml:id="S3.SS2.p2.m1.3">3</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="4" role="NUMBER" xml:id="S3.SS2.p2.m1.4">4</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>) chosen from the literature (Fig. <ref labelref="LABEL:fig:optical"/>B). It is assumed that a 3D geometric instance is composed of a stack of three layers of prismatic unit cells, each of which is vertically extruded and stacked (Fig. <ref labelref="LABEL:fig:optical"/>A). The geometries constructed in this way can be regarded as an instantiation of multilayered metasurfaces <cite class="ltx_citemacro_cite">[<bibref bibrefs="zhou2018multilayer,li2018wideband,marino2021harmonic,malek2022multifunctional,zhang2023high" separator="," yyseparator=","/>]</cite>, which offer richer design freedom than the single-layer counterpart. The height of each layer (<Math mode="inline" tex="h_{l},l=1,2,3" text="formulae@(list@(h _ l, l) = 1, list@(2, 3))" xml:id="S3.SS2.p2.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S3.SS2.p2.m2.4"/>
                  <XMRef idref="S3.SS2.p2.m2.5"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS2.p2.m2.4">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.SS2.p2.m2.4.1"/>
                        <XMRef idref="S3.SS2.p2.m2.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.SS2.p2.m2.4.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m2.1">l</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="S3.SS2.p2.m2.5">
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S3.SS2.p2.m2.2"/>
                      <XMRef idref="S3.SS2.p2.m2.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok meaning="2" role="NUMBER" xml:id="S3.SS2.p2.m2.2">2</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="3" role="NUMBER" xml:id="S3.SS2.p2.m2.3">3</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>) is allowed to continuously vary between 50 and 150 nm. Herein we do not consider parametric variations of a given type of unit cell cross-section; yet those can be trivially incorporated in the proposed design framework if necessary.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:optical" placement="h" xml:id="S3.F4">
        <tags>
          <tag>Figure 4</tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <graphics candidates="fig/optical.pdf" class="ltx_centering" graphic="fig/optical.pdf" options="width=346.89731pt,keepaspectratio=true" xml:id="S3.F4.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>Optical metasurface design problem configuration and results. (A-B) Design variables (materials, layer heights, and cross-section geometry types). (C) A sample absorbance spectrum and the wavelength intervals (highlighted wavelength regions) corresponding to absorbance above the threshold <Math mode="inline" tex="t" text="t" xml:id="S3.F4.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math>. The design objective is to generate new optical metasurface designs that exhibit higher absorbance than a threshold <Math mode="inline" tex="t" text="t" xml:id="S3.F4.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> at the user-defined wavelength interval(s). (D) KDE of the estimated likelihood for generated designs. (E) Validation metrics under varying sampling thresholds. (F) Designs (geometries and material selections) and corresponding absorbance spectra of five generated metasurfaces with the highest likelihood of satisfying specified target high-absorbance regions (marked as highlighted wavelength regions). Here all five designs satisfy the target. Generated designs for other targets are shown in <text font="italic">Appendix, Figs. <ref labelref="LABEL:fig:support_optical_1"/>-<ref labelref="LABEL:fig:support_optical_2"/></text>.
</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 4</tag>Optical metasurface design problem configuration and results. (A-B) Design variables (materials, layer heights, and cross-section geometry types). (C) A sample absorbance spectrum and the wavelength intervals (highlighted wavelength regions) corresponding to absorbance above the threshold <Math mode="inline" tex="t" text="t" xml:id="S3.F4.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math>. The design objective is to generate new optical metasurface designs that exhibit higher absorbance than a threshold <Math mode="inline" tex="t" text="t" xml:id="S3.F4.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> at the user-defined wavelength interval(s). (D) KDE of the estimated likelihood for generated designs. (E) Validation metrics under varying sampling thresholds. (F) Designs (geometries and material selections) and corresponding absorbance spectra of five generated metasurfaces with the highest likelihood of satisfying specified target high-absorbance regions (marked as highlighted wavelength regions). Here all five designs satisfy the target. Generated designs for other targets are shown in <text font="italic">Appendix, Figs. <ref labelref="LABEL:fig:support_optical_1"/>-<ref labelref="LABEL:fig:support_optical_2"/></text>.
</caption>
      </figure>
      <para xml:id="S3.SS2.p3">
        <p><!--  %****␣main.tex␣Line␣250␣**** -->We also design the material of each layer (<Math mode="inline" tex="m_{l},l=1,2,3" text="formulae@(list@(m _ l, l) = 1, list@(2, 3))" xml:id="S3.SS2.p3.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S3.SS2.p3.m1.4"/>
                  <XMRef idref="S3.SS2.p3.m1.5"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS2.p3.m1.4">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.SS2.p3.m1.4.1"/>
                        <XMRef idref="S3.SS2.p3.m1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.SS2.p3.m1.4.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">m</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p3.m1.1">l</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="S3.SS2.p3.m1.5">
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S3.SS2.p3.m1.2"/>
                      <XMRef idref="S3.SS2.p3.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok meaning="2" role="NUMBER" xml:id="S3.SS2.p3.m1.2">2</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="3" role="NUMBER" xml:id="S3.SS2.p3.m1.3">3</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>). Three dielectric materials of interest, each of which is assigned to a different color in Fig. <ref labelref="LABEL:fig:optical"/>A, are Ti (red), Si (blue), and Ge (yellow). In general, a dielectric material is characterized through a complex refractive index <Math mode="inline" tex="\tilde{n}\in\mathbb{C}" text="tilde@(n) element-of C" xml:id="S3.SS2.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok font="blackboard" role="UNKNOWN">C</XMTok>
              </XMApp>
            </XMath>
          </Math> defined as <Math mode="inline" tex="\tilde{n}=n+jk" text="tilde@(n) = n + j * k" xml:id="S3.SS2.p3.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">j</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, where <Math mode="inline" tex="j=\sqrt{-1}" text="j = square-root@(- 1)" xml:id="S3.SS2.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMApp>
                  <XMTok meaning="square-root"/>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is the imaginary unit, <Math mode="inline" tex="n\in\mathbb{R}" text="n element-of R" xml:id="S3.SS2.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math> involves the speed at which the light propagates through the material, and <Math mode="inline" tex="k\in\mathbb{R}" text="k element-of R" xml:id="S3.SS2.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math> is the extinction coefficient that dictates the energy loss due to the material.
Within the frequency regime of interest, those exhibit nonlinear dispersion; both the real and imaginary terms in general are a non-analytic function of excitation wavelength <Math mode="inline" tex="s" text="s" xml:id="S3.SS2.p3.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math>, i.e., <Math mode="inline" tex="n(s)" text="n * s" xml:id="S3.SS2.p3.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p3.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p3.m8.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="k(s)" text="k * s" xml:id="S3.SS2.p3.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p3.m9.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p3.m9.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. In addition, the impact of the same material choice on the spectral response <Math mode="inline" tex="A(s)" text="A * s" xml:id="S3.SS2.p3.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p3.m10.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p3.m10.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> varies depending on the layer location at which the material is placed. Thus the highlight of this case study is the combinatorial nature of design, whose spectral responses are affected by the joint contributions of geometry and material.</p>
      </para>
      <para xml:id="S3.SS2.p4">
        <p>Based on the above configuration, we randomly sampled 258 sets of design variables <Math mode="inline" tex="\mathbf{x}=(c,h_{1},h_{2},h_{3},m_{1},m_{2},m_{3})" text="x = vector@(c, h _ 1, h _ 2, h _ 3, m _ 1, m _ 2, m _ 3)" xml:id="S3.SS2.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="bold" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="S3.SS2.p4.m1.1"/>
                    <XMRef idref="S3.SS2.p4.m1.2"/>
                    <XMRef idref="S3.SS2.p4.m1.3"/>
                    <XMRef idref="S3.SS2.p4.m1.4"/>
                    <XMRef idref="S3.SS2.p4.m1.5"/>
                    <XMRef idref="S3.SS2.p4.m1.6"/>
                    <XMRef idref="S3.SS2.p4.m1.7"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p4.m1.1">c</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m1.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m1.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m1.5">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m1.6">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m1.7">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                      <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and computed their corresponding absorbance spectra using wave analysis. We set <Math mode="inline" tex="t=0.9" text="t = 0.9" xml:id="S3.SS2.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
              </XMApp>
            </XMath>
          </Math> as the absorbance threshold, so that “high” absorbance means the absorbance <Math mode="inline" tex="A(s)" text="A * s" xml:id="S3.SS2.p4.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p4.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p4.m3.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is no less than 0.9. We trained a random forest on 206 training data (i.e., 80% of the 258 designs and corresponding absorbance spectra) to predict whether “high” absorbance is presented (i.e., the binary indicator <Math mode="inline" tex="y=1" text="y = 1" xml:id="S3.SS2.p4.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>) at a wavelength <Math mode="inline" tex="s" text="s" xml:id="S3.SS2.p4.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> for a given design <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="S3.SS2.p4.m6">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math>. The trained random forest has a test F1 score of 0.83. The confusion matrix on test data is shown in <text font="italic">Appendix, Tab. <ref labelref="LABEL:tab:f1_optical"/></text>.</p>
      </para>
      <para xml:id="S3.SS2.p5">
        <p>Note that this problem involves inverse design with both continuous and categorical variables, which common optimization and generative modeling-based inverse design cannot handle well without special treatment <cite class="ltx_citemacro_cite">[<bibref bibrefs="zhang2020bayesian,ma2020vaem,xu2018synthesizing" separator="," yyseparator=","/>]</cite>. On the other hand, our random forest-based method can naturally address such mixed-variable problems without any issues.</p>
      </para>
      <para xml:id="S3.SS2.p6">
        <p>Similar to the acoustic metamaterial design problem, we use 10 randomly created targets to evaluate the inverse design performance of RIGID, except that here a target is represented as the wavelength range(s) within which absorbance should be at least 0.9. We generated 100 designs for each target by sampling from the estimated likelihood distribution. Among the 1,000 generated solutions, we successfully conducted wave analysis for 911 designs and obtained their absorbance spectra. Figure <ref labelref="LABEL:fig:optical"/>D shows the KDE for the likelihood of these 911 designs, conditioned on their target satisfaction. The densities share similar behavior as in the acoustic problem (Fig. <ref labelref="LABEL:fig:acoustic"/>D) —unsatisfied/infeasible designs <Math mode="inline" tex="\mathcal{D}\backslash\mathcal{D}_{\text{feas}}" text="D backslash D _ [feas]" xml:id="S3.SS2.p6.m1">
            <XMath>
              <XMApp>
                <XMTok name="backslash" role="MULOP">\</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMText><text fontsize="70%">feas</text></XMText>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> are concentrated at low likelihood regions, which causes the likelihood density of satisfied/feasible designs <Math mode="inline" tex="\mathcal{D}_{\text{feas}}" text="D _ [feas]" xml:id="S3.SS2.p6.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMText><text fontsize="70%">feas</text></XMText>
              </XMApp>
            </XMath>
          </Math> to be a result of shifting some of <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S3.SS2.p6.m3">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>’s density from left (low likelihood) to right (high likelihood). The sampling threshold and metrics relation shown in Fig. <ref labelref="LABEL:fig:optical"/>E also follow the same trend as in the acoustic problem (Fig. <ref labelref="LABEL:fig:acoustic"/>E), which again demonstrates a strong positive correlation between the estimated likelihood and the probability of generated designs actually achieving their targets.</p>
      </para>
      <para xml:id="S3.SS2.p7">
        <p>Figure <ref labelref="LABEL:fig:optical"/>F shows generated optical metasurface designs with the top five likelihood estimations for a randomly created target. While the materials, cross-section geometries, and layer heights of generated designs can be different, all the designs satisfy the target (Fig. <ref labelref="LABEL:fig:optical"/>F, right panel). To further enhance the diversity of final solutions, we can use sampling strategies such as the one proposed in Ref. <cite class="ltx_citemacro_cite">[<bibref bibrefs="chan2021metaset,lee2023t" separator="," yyseparator=","/>]</cite> to identify a subset (of generated solutions) that simultaneously exhibits high likelihood and high diversity. Generated designs based on the other nine targets can be found in <text font="italic">Appendix, Figs. <ref labelref="LABEL:fig:support_optical_1"/>-<ref labelref="LABEL:fig:support_optical_2"/></text>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:synthetic" xml:id="S3.SS3">
      <tags>
        <tag>3.3</tag>
        <tag role="autoref">subsection 3.3</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">§3.3</tag>
      </tags>
      <title><tag close=" ">3.3</tag>Synthetic Design Problems for Rapid Validation and Visualization</title>
      <para xml:id="S3.SS3.p1">
        <p>While the above metamaterial design problems represent practical use cases, the validation study is time-consuming due to the expensive computation of metamaterials’ responses such as dispersion relations and absorbance spectra. To allow fast validation of the proposed method and easier inspection of the estimated likelihood in the design space, we create two synthetic case studies. Both problems have 2-dimensional “design spaces” that allow easy visualization.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:synthetic_data" placement="h" xml:id="S3.F5">
        <tags>
          <tag>Figure 5</tag>
          <tag role="autoref">Figure 5</tag>
          <tag role="refnum">5</tag>
          <tag role="typerefnum">Figure 5</tag>
        </tags>
        <graphics candidates="fig/synthetic_data.pdf" class="ltx_centering" graphic="fig/synthetic_data.pdf" options="width=346.89731pt,keepaspectratio=true" xml:id="S3.F5.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">5</tag>Synthetic data creation for (A) the SqExp problem and (B) the SupSin problem. For each problem, the left panel shows 100 functions with randomly sampled parameters <Math mode="inline" tex="a" text="a" xml:id="S3.F5.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.F5.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math>. We treat <Math mode="inline" tex="a" text="a" xml:id="S3.F5.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.F5.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math> as synthetic design variables, and the corresponding functions as quantitative responses (e.g., absorbance spectra of optical metasurfaces). The right panel shows qualitative responses (e.g., high-absorbance wavelength ranges or bandgaps) are simulated by synthetic ranges, derived by thresholding the 100 functions (Equations <ref labelref="LABEL:eq:test_func_sqexp"/> and <ref labelref="LABEL:eq:test_func_sin"/> with threshold <Math mode="inline" tex="t" text="t" xml:id="S3.F5.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math>=0.9).</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 5</tag>Synthetic data creation for (A) the SqExp problem and (B) the SupSin problem. For each problem, the left panel shows 100 functions with randomly sampled parameters <Math mode="inline" tex="a" text="a" xml:id="S3.F5.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.F5.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math>. We treat <Math mode="inline" tex="a" text="a" xml:id="S3.F5.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.F5.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math> as synthetic design variables, and the corresponding functions as quantitative responses (e.g., absorbance spectra of optical metasurfaces). The right panel shows qualitative responses (e.g., high-absorbance wavelength ranges or bandgaps) are simulated by synthetic ranges, derived by thresholding the 100 functions (Equations <ref labelref="LABEL:eq:test_func_sqexp"/> and <ref labelref="LABEL:eq:test_func_sin"/> with threshold <Math mode="inline" tex="t" text="t" xml:id="S3.F5.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math>=0.9).</caption>
      </figure>
      <paragraph inlist="toc" xml:id="S3.SS3.SSS0.Px1">
        <title>SqExp Problem</title>
        <para xml:id="S3.SS3.SSS0.Px1.p1">
          <p>To construct the first synthetic problem, we used a <text font="italic">squared exponential function</text> with tunable parameters <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px1.p1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px1.p1.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> to mimic the quantitative functional response of metamaterials. The qualitative response (e.g., “high” or “low” energy absorption at a wavelength) is defined as:</p>
          <equation labels="LABEL:eq:test_func_sqexp" xml:id="S3.E2">
            <tags>
              <tag>(2)</tag>
              <tag role="autoref">Equation 2</tag>
              <tag role="refnum">2</tag>
            </tags>
            <Math mode="display" tex="I(a,b;s)=\begin{cases}0,&amp;\text{if $z=\exp\left(-{\left(\frac{s-a}{0.3b+0.1}%&#10;\right)^{2}}\right)&lt;t$}\\&#10;1,&amp;\text{otherwise}\end{cases}," text="I * vector@(a, b, s) = cases@(0, [if z=exp(-(-sa+⁢0.3b0.1)2)&lt;t], 1, [otherwise])" xml:id="S3.E2.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S3.E2.m1.8"/>
                  <XMWrap>
                    <XMApp xml:id="S3.E2.m1.8">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="vector"/>
                            <XMRef idref="S3.E2.m1.5"/>
                            <XMRef idref="S3.E2.m1.6"/>
                            <XMRef idref="S3.E2.m1.7"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.5">a</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.6">b</XMTok>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.7">s</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="cases"/>
                          <XMRef idref="S3.E2.m1.1"/>
                          <XMRef idref="S3.E2.m1.2"/>
                          <XMRef idref="S3.E2.m1.3"/>
                          <XMRef idref="S3.E2.m1.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">{</XMTok>
                          <XMArray>
                            <XMRow>
                              <XMCell align="left">
                                <XMDual xml:id="S3.E2.m1.1">
                                  <XMRef idref="S3.E2.m1.1.1"/>
                                  <XMWrap>
                                    <XMTok meaning="0" role="NUMBER" xml:id="S3.E2.m1.1.1">0</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMCell>
                              <XMCell align="left">
                                <XMText xml:id="S3.E2.m1.2">if <Math mode="inline" tex="z=\exp\left(-{\left(\frac{s-a}{0.3b+0.1}\right)^{2}}\right)&lt;t" text="z = exponential@(- ((s - a) / (0.3 * b + 0.1)) ^ 2) &lt; t" xml:id="S3.E2.m1.m1">
                                    <XMath>
                                      <XMApp>
                                        <XMTok meaning="multirelation"/>
                                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMRef idref="S3.E2.m1.m1.2"/>
                                            <XMRef idref="S3.E2.m1.m1.3"/>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E2.m1.m1.2">exp</XMTok>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                                              <XMApp xml:id="S3.E2.m1.m1.3">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                  <XMDual>
                                                    <XMRef idref="S3.E2.m1.m1.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                                      <XMApp xml:id="S3.E2.m1.m1.1">
                                                        <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                                        <XMApp>
                                                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                                        </XMApp>
                                                        <XMApp>
                                                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                          <XMApp>
                                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                            <XMTok fontsize="70%" meaning="0.3" role="NUMBER">0.3</XMTok>
                                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                                                          </XMApp>
                                                          <XMTok fontsize="70%" meaning="0.1" role="NUMBER">0.1</XMTok>
                                                        </XMApp>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                            </XMWrap>
                                          </XMApp>
                                        </XMDual>
                                        <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMath>
                                  </Math></XMText>
                              </XMCell>
                            </XMRow>
                            <XMRow>
                              <XMCell align="left">
                                <XMDual xml:id="S3.E2.m1.3">
                                  <XMRef idref="S3.E2.m1.3.1"/>
                                  <XMWrap>
                                    <XMTok meaning="1" role="NUMBER" xml:id="S3.E2.m1.3.1">1</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMCell>
                              <XMCell align="left">
                                <XMText xml:id="S3.E2.m1.4">otherwise</XMText>
                              </XMCell>
                            </XMRow>
                          </XMArray>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>where <Math mode="inline" tex="z" text="z" xml:id="S3.SS3.SSS0.Px1.p1.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math> represents quantitative response and <Math mode="inline" tex="t" text="t" xml:id="S3.SS3.SSS0.Px1.p1.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMath>
            </Math> is a threshold that converts <Math mode="inline" tex="z" text="z" xml:id="S3.SS3.SSS0.Px1.p1.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math> into a qualitative response <Math mode="inline" tex="I(a,b;s)" text="I * vector@(a, b, s)" xml:id="S3.SS3.SSS0.Px1.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="S3.SS3.SSS0.Px1.p1.m6.1"/>
                      <XMRef idref="S3.SS3.SSS0.Px1.p1.m6.2"/>
                      <XMRef idref="S3.SS3.SSS0.Px1.p1.m6.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m6.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m6.2">b</XMTok>
                      <XMTok role="PUNCT">;</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m6.3">s</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>. Specifically, <Math mode="inline" tex="I(a,b;s)=1" text="I * vector@(a, b, s) = 1" xml:id="S3.SS3.SSS0.Px1.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="vector"/>
                        <XMRef idref="S3.SS3.SSS0.Px1.p1.m7.1"/>
                        <XMRef idref="S3.SS3.SSS0.Px1.p1.m7.2"/>
                        <XMRef idref="S3.SS3.SSS0.Px1.p1.m7.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m7.1">a</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m7.2">b</XMTok>
                        <XMTok role="PUNCT">;</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m7.3">s</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math> can mean the existence of a bandgap or high absorbance at a frequency <Math mode="inline" tex="s" text="s" xml:id="S3.SS3.SSS0.Px1.p1.m8">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
              </XMath>
            </Math>. Then <Math mode="inline" tex="\{s|I(a,b;s)=1\}" text="conditional-set@(s, I * vector@(a, b, s) = 1)" xml:id="S3.SS3.SSS0.Px1.p1.m9">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="conditional-set"/>
                    <XMRef idref="S3.SS3.SSS0.Px1.p1.m9.4"/>
                    <XMRef idref="S3.SS3.SSS0.Px1.p1.m9.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m9.4">s</XMTok>
                    <XMTok role="MIDDLE" stretchy="false">|</XMTok>
                    <XMApp xml:id="S3.SS3.SSS0.Px1.p1.m9.5">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="vector"/>
                            <XMRef idref="S3.SS3.SSS0.Px1.p1.m9.1"/>
                            <XMRef idref="S3.SS3.SSS0.Px1.p1.m9.2"/>
                            <XMRef idref="S3.SS3.SSS0.Px1.p1.m9.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m9.1">a</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m9.2">b</XMTok>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px1.p1.m9.3">s</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> represents a range of <Math mode="inline" tex="s" text="s" xml:id="S3.SS3.SSS0.Px1.p1.m10">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
              </XMath>
            </Math> that mimics our design targets, such as the bandgap or the frequency range of high absorbance. By varying <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px1.p1.m11">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px1.p1.m12">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math>, we can produce different synthetic responses and ranges. Therefore, we can use <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px1.p1.m13">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px1.p1.m14">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> as synthetic design variables. There is a clear relation between these design variables and the range that Eq. <ref labelref="LABEL:eq:test_func_sqexp"/> creates — <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px1.p1.m15">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px1.p1.m16">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> control the center location and the width of the range, respectively.</p>
        </para>
        <para xml:id="S3.SS3.SSS0.Px1.p2">
          <p>In this design problem, we sampled 100 sets of <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px1.p2.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px1.p2.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> uniformly at random. We set <Math mode="inline" tex="t" text="t" xml:id="S3.SS3.SSS0.Px1.p2.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMath>
            </Math> as 0.9. Based on Eq. <ref labelref="LABEL:eq:test_func_sqexp"/>, we obtained the corresponding responses (Fig. <ref labelref="LABEL:fig:synthetic_data"/>A). These sets of <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px1.p2.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math>, <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px1.p2.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math>, and responses constitute a dataset for training and testing our model.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="S3.SS3.SSS0.Px2">
        <title>SupSin Problem</title>
        <para xml:id="S3.SS3.SSS0.Px2.p1">
          <p>Another synthetic design problem was constructed by replacing
the squared exponential function in the SqExp problem with a <text font="italic">superposed sine function</text>. Given synthetic design variables <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p1.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math>, we can produce qualitative responses using the following equation:</p>
          <equation labels="LABEL:eq:test_func_sin" xml:id="S3.E3">
            <tags>
              <tag>(3)</tag>
              <tag role="autoref">Equation 3</tag>
              <tag role="refnum">3</tag>
            </tags>
            <Math mode="display" tex="I(a,b;s)=\begin{cases}0,&amp;\text{if $z=\sin\left(2\pi(s+a)\right)+\sin\left(3\pi%&#10;(s+b)\right)&lt;t$}\\&#10;1,&amp;\text{otherwise}\end{cases}." text="I * vector@(a, b, s) = cases@(0, [if z=+sin(⁢2π(+sa))sin(⁢3π(+sb))&lt;t], 1, [otherwise])" xml:id="S3.E3.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S3.E3.m1.8"/>
                  <XMWrap>
                    <XMApp xml:id="S3.E3.m1.8">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="vector"/>
                            <XMRef idref="S3.E3.m1.5"/>
                            <XMRef idref="S3.E3.m1.6"/>
                            <XMRef idref="S3.E3.m1.7"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E3.m1.5">a</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E3.m1.6">b</XMTok>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E3.m1.7">s</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="cases"/>
                          <XMRef idref="S3.E3.m1.1"/>
                          <XMRef idref="S3.E3.m1.2"/>
                          <XMRef idref="S3.E3.m1.3"/>
                          <XMRef idref="S3.E3.m1.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">{</XMTok>
                          <XMArray>
                            <XMRow>
                              <XMCell align="left">
                                <XMDual xml:id="S3.E3.m1.1">
                                  <XMRef idref="S3.E3.m1.1.1"/>
                                  <XMWrap>
                                    <XMTok meaning="0" role="NUMBER" xml:id="S3.E3.m1.1.1">0</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMCell>
                              <XMCell align="left">
                                <XMText xml:id="S3.E3.m1.2">if <Math mode="inline" tex="z=\sin\left(2\pi(s+a)\right)+\sin\left(3\pi(s+b)\right)&lt;t" text="z = sine@(2 * pi * (s + a)) + sine@(3 * pi * (s + b)) &lt; t" xml:id="S3.E3.m1.m1">
                                    <XMath>
                                      <XMApp>
                                        <XMTok meaning="multirelation"/>
                                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMRef idref="S3.E3.m1.m1.1"/>
                                              <XMRef idref="S3.E3.m1.m1.3"/>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="S3.E3.m1.m1.1">sin</XMTok>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                                <XMApp xml:id="S3.E3.m1.m1.3">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="S3.E3.m1.m1.3.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="S3.E3.m1.m1.3.1">
                                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                              </XMWrap>
                                            </XMApp>
                                          </XMDual>
                                          <XMDual>
                                            <XMApp>
                                              <XMRef idref="S3.E3.m1.m1.2"/>
                                              <XMRef idref="S3.E3.m1.m1.4"/>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="S3.E3.m1.m1.2">sin</XMTok>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                                <XMApp xml:id="S3.E3.m1.m1.4">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="S3.E3.m1.m1.4.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="S3.E3.m1.m1.4.1">
                                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                              </XMWrap>
                                            </XMApp>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMath>
                                  </Math></XMText>
                              </XMCell>
                            </XMRow>
                            <XMRow>
                              <XMCell align="left">
                                <XMDual xml:id="S3.E3.m1.3">
                                  <XMRef idref="S3.E3.m1.3.1"/>
                                  <XMWrap>
                                    <XMTok meaning="1" role="NUMBER" xml:id="S3.E3.m1.3.1">1</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMCell>
                              <XMCell align="left">
                                <XMText xml:id="S3.E3.m1.4">otherwise</XMText>
                              </XMCell>
                            </XMRow>
                          </XMArray>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>Same as in the SqExp problem, we set <Math mode="inline" tex="t=0.9" text="t = 0.9" xml:id="S3.SS3.SSS0.Px2.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                </XMApp>
              </XMath>
            </Math> and created a dataset with 100 sets of synthetic design variables and corresponding ranges derived from synthetic responses (Fig. <ref labelref="LABEL:fig:synthetic_data"/><!--  %****␣main.tex␣Line␣300␣**** -->B).
Unlike the squared exponential function, the superposed sine function can be multimodal, which means it can result in multiple synthetic ranges to mimic, for example, multiple bandgaps. The bandgap locations are controlled by <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p1.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p1.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math>.</p>
        </para>
<!--  %\begin{SCfigure*} 
     %\centering 
     %\includegraphics[width=0.7\textwidth]{fig/synthetic_sqexp.pdf} 
     %\caption{Synthetic␣data␣creation␣and␣method␣validation␣in␣the␣SqExp␣problem.␣(A)~100␣squared␣exponential␣functions␣with␣randomly␣sampled␣parameters␣$a$␣and␣$b$.␣We␣treat␣$a$␣and␣$b$␣as␣synthetic␣design␣variables.␣Qualitative␣responses␣(e.g.,␣bandgaps␣and␣high-absorbance␣wavelength␣ranges)␣are␣simulated␣by␣synthetic␣ranges,␣derived␣by␣thresholding␣the␣100␣functions␣(Eq.~\ref{eq:test_func_sqexp}␣with␣threshold␣$t$=0.9).␣(B)~Likelihood␣function␣values␣for␣randomly␣created␣design␣targets.␣Red␣lines␣show␣boundaries␣of␣actual␣feasible␣regions␣associated␣with␣the␣targets.␣(C)~Likelihood␣function␣values␣estimated␣by␣random␣forests␣with␣varying␣numbers␣of␣decision␣trees.␣The␣design␣target␣is␣set␣as␣$\{[0.45,␣0.48]\}$.␣(D)~Validation␣metrics␣for␣inverse␣design␣generation.} 
     %\label{fig:synthetic_sqexp} 
     %\end{SCfigure*} 
     %\begin{SCfigure*} 
     %\centering 
     %\includegraphics[width=0.7\textwidth]{fig/synthetic_supsin.pdf} 
     %\caption{Synthetic␣data␣creation␣and␣method␣validation␣in␣the␣SupSin␣problem.␣(A)~100␣squared␣exponential␣functions␣with␣randomly␣sampled␣parameters␣$a$␣and␣$b$.␣We␣treat␣$a$␣and␣$b$␣as␣synthetic␣design␣variables.␣Qualitative␣responses␣(e.g.,␣bandgaps␣and␣high-absorbance␣wavelength␣ranges)␣are␣simulated␣by␣synthetic␣ranges,␣derived␣by␣thresholding␣the␣100␣functions␣(Eq.~\ref{eq:test_func_sin}␣with␣threshold␣$t$=0.9).␣(B)~Likelihood␣function␣values␣for␣randomly␣created␣design␣targets.␣Red␣lines␣show␣boundaries␣of␣actual␣feasible␣regions␣associated␣with␣the␣targets.␣(C)~Likelihood␣function␣values␣estimated␣by␣random␣forests␣with␣varying␣numbers␣of␣decision␣trees.␣The␣design␣target␣is␣set␣as␣$\{[0.63,␣0.68],␣[0.69,␣0.71]\}$.␣(D)~Validation␣metrics␣for␣inverse␣design␣generation.} 
     %\label{fig:synthetic_supsin} 
     %\end{SCfigure*} -->        <para xml:id="S3.SS3.SSS0.Px2.p2">
          <p>For each synthetic example, we split the data into 80 training data and 20 test data, and trained a random forest, with the same hyperparameter settings as the other problems, to predict the binary indicators <Math mode="inline" tex="I(a,b;s)" text="I * vector@(a, b, s)" xml:id="S3.SS3.SSS0.Px2.p2.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="S3.SS3.SSS0.Px2.p2.m1.1"/>
                      <XMRef idref="S3.SS3.SSS0.Px2.p2.m1.2"/>
                      <XMRef idref="S3.SS3.SSS0.Px2.p2.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px2.p2.m1.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px2.p2.m1.2">b</XMTok>
                      <XMTok role="PUNCT">;</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.SSS0.Px2.p2.m1.3">s</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>. The F1 scores are 0.85 and 0.86 for the SqExp and the SupSin problems, respectively. The resulting confusion matrices are shown in <text font="italic">Appendix, Tables <ref labelref="LABEL:tab:f1_test_func_sqexp"/>-<ref labelref="LABEL:tab:f1_test_func_sin"/></text>. We evaluated the inverse design performance with the trained models.</p>
        </para>
        <figure inlist="lof" labels="LABEL:fig:synthetic_results" xml:id="S3.F6">
          <tags>
            <tag>Figure 6</tag>
            <tag role="autoref">Figure 6</tag>
            <tag role="refnum">6</tag>
            <tag role="typerefnum">Figure 6</tag>
          </tags>
          <graphics candidates="fig/synthetic_results.pdf" class="ltx_centering" graphic="fig/synthetic_results.pdf" options="width=346.89731pt,keepaspectratio=true" xml:id="S3.F6.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">6</tag>Visualization of estimated likelihood and validation metrics for synthetic problems. (A) Likelihood function values for randomly created design targets. Orange lines show boundaries of actual feasible regions associated with the targets. (B) Likelihood function values estimated by random forests with varying numbers of decision trees. The design target is set as <Math mode="inline" tex="\{[0.45,0.48]\}" text="set@(closed-interval@(0.45, 0.48))" xml:id="S3.F6.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.F6.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S3.F6.m1.3">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S3.F6.m1.1"/>
                        <XMRef idref="S3.F6.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="0.45" role="NUMBER" xml:id="S3.F6.m1.1">0.45</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0.48" role="NUMBER" xml:id="S3.F6.m1.2">0.48</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for the SqExp problem and <Math mode="inline" tex="\{[0.63,0.68],[0.69,0.71]\}" text="set@(closed-interval@(0.63, 0.68), closed-interval@(0.69, 0.71))" xml:id="S3.F6.m2">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.F6.m2.5"/>
                    <XMRef idref="S3.F6.m2.6"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S3.F6.m2.5">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S3.F6.m2.1"/>
                        <XMRef idref="S3.F6.m2.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="0.63" role="NUMBER" xml:id="S3.F6.m2.1">0.63</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0.68" role="NUMBER" xml:id="S3.F6.m2.2">0.68</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMDual xml:id="S3.F6.m2.6">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S3.F6.m2.3"/>
                        <XMRef idref="S3.F6.m2.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="0.69" role="NUMBER" xml:id="S3.F6.m2.3">0.69</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0.71" role="NUMBER" xml:id="S3.F6.m2.4">0.71</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for the SupSin problem. (C) Validation metrics for inverse design generation.</toccaption>
          <caption class="ltx_centering"><tag close=": ">Figure 6</tag>Visualization of estimated likelihood and validation metrics for synthetic problems. (A) Likelihood function values for randomly created design targets. Orange lines show boundaries of actual feasible regions associated with the targets. (B) Likelihood function values estimated by random forests with varying numbers of decision trees. The design target is set as <Math mode="inline" tex="\{[0.45,0.48]\}" text="set@(closed-interval@(0.45, 0.48))" xml:id="S3.F6.m3">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.F6.m3.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S3.F6.m3.3">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S3.F6.m3.1"/>
                        <XMRef idref="S3.F6.m3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="0.45" role="NUMBER" xml:id="S3.F6.m3.1">0.45</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0.48" role="NUMBER" xml:id="S3.F6.m3.2">0.48</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for the SqExp problem and <Math mode="inline" tex="\{[0.63,0.68],[0.69,0.71]\}" text="set@(closed-interval@(0.63, 0.68), closed-interval@(0.69, 0.71))" xml:id="S3.F6.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.F6.m4.5"/>
                    <XMRef idref="S3.F6.m4.6"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S3.F6.m4.5">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S3.F6.m4.1"/>
                        <XMRef idref="S3.F6.m4.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="0.63" role="NUMBER" xml:id="S3.F6.m4.1">0.63</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0.68" role="NUMBER" xml:id="S3.F6.m4.2">0.68</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMDual xml:id="S3.F6.m4.6">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S3.F6.m4.3"/>
                        <XMRef idref="S3.F6.m4.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="0.69" role="NUMBER" xml:id="S3.F6.m4.3">0.69</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0.71" role="NUMBER" xml:id="S3.F6.m4.4">0.71</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for the SupSin problem. (C) Validation metrics for inverse design generation.</caption>
        </figure>
        <para xml:id="S3.SS3.SSS0.Px2.p3">
          <p>Due to the fast evaluation of Equations <ref labelref="LABEL:eq:test_func_sqexp"/> and <ref labelref="LABEL:eq:test_func_sin"/>, we can exhaust all the possible solutions in the design space to obtain the ground-truth feasible region(s) for a target. Figure <ref labelref="LABEL:fig:synthetic_results"/>A shows the estimated likelihood values and the ground-truth feasible regions under randomly created targets. In general, high-likelihood regions match actual feasible regions well, which further demonstrates the effectiveness of RIGID. We can also observe that feasible regions in the SqExp and the SupSin problems follow distinct patterns. In the SqExp problem, <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p3.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p3.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> control the center location and the width of the output range, respectively. Therefore, the position of the feasible region along the <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p3.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math>-axis moves with the location of the target range, while the feasible region gradually shrinks as <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p3.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> decreases since the decrease of <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p3.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> (i.e., output range width) causes the choice of <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p3.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> (i.e., output range center location) to be more restricted to fit the target range. In the SupSin problem, there might be multiple bandgaps appearing at the peaks of the superposed sine function in Eq. <ref labelref="LABEL:eq:test_func_sin"/>. Design variables <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p3.m7">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p3.m8">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math> control bandgap locations by translating each sine function. Due to the sine function’s periodicity, we can obtain multiple feasible regions along both <Math mode="inline" tex="a" text="a" xml:id="S3.SS3.SSS0.Px2.p3.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math>- and <Math mode="inline" tex="b" text="b" xml:id="S3.SS3.SSS0.Px2.p3.m10">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
              </XMath>
            </Math>-axes.
Figure <ref labelref="LABEL:fig:synthetic_results"/>A shows that the likelihood estimation by RIGID successfully captured the above-mentioned patterns of feasible regions.</p>
        </para>
        <para xml:id="S3.SS3.SSS0.Px2.p4">
          <p>Figure <ref labelref="LABEL:fig:synthetic_results"/>B demonstrates how the estimated likelihood varies when increasing the number of trees in a random forest. With a single decision tree, the estimated likelihood function is almost a binary function and highly inaccurate. The likelihood in the SqExp case is even zero everywhere, which makes it impossible to sample designs based on the likelihood. As the number of trees increases, the likelihood function becomes smoother and eventually converges.</p>
        </para>
        <para xml:id="S3.SS3.SSS0.Px2.p5">
          <p>Besides these qualitative visual inspections, we also calculated the metrics proposed in Eq. <ref labelref="LABEL:eq:metrics"/>, as shown in Fig. <ref labelref="LABEL:fig:synthetic_results"/>C. For each of the two synthetic problems, these metrics were computed on 500 designs generated by giving five random target ranges. Again, the satisfaction rate and the average score increase with the sampling threshold, indicating a strong correlation between the sampling threshold and the probability of generated designs actually achieving their targets. In both problems, all the selected designs satisfy their targets (i.e., the satisfaction rates and average scores reach 1) when the sampling threshold reaches 0.8.</p>
        </para>
      </paragraph>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:conclusion" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Summary and Outlook</title>
    <para xml:id="S4.p1">
      <p>We proposed RIGID, a single-shot inverse design method that generates metamaterials to satisfy qualitative behaviors of functional responses. Such qualitative behaviors are important design targets in many applications such as tailoring bandgaps of acoustic metamaterials for wave-guiding, focusing, and vibration mitigation, or tailoring the absorption level of optical metasurfaces at certain wavelengths for medical sensing, imaging, and communication applications. Unlike most existing inverse design methods that require training an inverse model to map targets to designs, the RIGID method takes advantage of the random forest’s interpretability and derives the likelihood of target satisfaction by probing the trained forward model. Incorporated with MCMC, one can sample a desired number of new designs based on the estimated likelihood. Therefore, RIGID functions as a generative model that can capture the conditional distribution of satisfying designs given a target, or in other words, the one-to-many mapping from the target to satisfying designs. Using both real-world and synthetic design problems, we demonstrated that RIGID is efficient and effective on datasets with training sample sizes smaller than 250. Thus, RIGID is particularly useful when data collection is expensive, as in many cases where high-fidelity simulation or experimental data are needed. We used both qualitative and quantitative approaches to validate the proposed method. The quantitative results revealed a strong correlation between the estimated likelihood of a solution and its probability of actually achieving the target, which demonstrated the effectiveness of the likelihood estimation. Due to the fast evaluation of output responses and the transparency of ground-truth solutions, the proposed synthetic problems can be used for future benchmarking studies of metamaterial design problems.</p>
    </para>
    <para xml:id="S4.p2">
      <p>While we address qualitative design targets in this study, the idea of using random forest-based models for inverse design has the potential to generalize to quantitative targets. Such problems can be, for example, generating optical metasurface designs with specific optical spectra <cite class="ltx_citemacro_cite">[<bibref bibrefs="liu2018generative,ma2019probabilistic" separator="," yyseparator=","/>]</cite>, generating functional materials with target nonlinear constitutive relations <cite class="ltx_citemacro_cite">[<bibref bibrefs="lew2023single,vlassis2023denoising" separator="," yyseparator=","/>]</cite>, or generating programmable metamaterials with prescribed functional responses <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2022digital,lin2023mechanical" separator="," yyseparator=","/>]</cite>. It is also straightforward to adjust the target to achieve multifunctionality (e.g., negative/positive Poisson’s ratio under low/high compression rate <cite class="ltx_citemacro_cite">[<bibref bibrefs="bossart2021oligomodal" separator="," yyseparator=","/>]</cite>).</p>
    </para>
    <para xml:id="S4.p3">
      <p>Although this study only demonstrates the RIGID method on parametric design (i.e., designs are represented by geometric and/or material parameters), the method also applies to shape or topological design problems where the shape or topology of designs can vary without being restricted to a limited number of geometric parameters <cite class="ltx_citemacro_cite">[<bibref bibrefs="liu2018generative,jiang2019free,ma2019probabilistic,wen2020robust,an2021multifunctional" separator="," yyseparator=","/>]</cite>. In those cases, as valid designs only lie on a lower-dimensional manifold of the design space, the likelihood of target satisfaction will be zero almost everywhere in the original design space. Thus before applying RIGID, we need to obtain a latent representation that compactly captures the manifold of valid designs <cite class="ltx_citemacro_cite">[<bibref bibrefs="wang2020deep,chen2023gan" separator="," yyseparator=","/>]</cite>, and use the latent representation as design variables for inverse design.</p>
    </para>
  </section>
  <section xml:id="Sx1">
    <title>Acknowledgement</title>
    <para xml:id="Sx1.p1">
      <p>This work was supported by the startup funds from the J. Mike Walker ’66 Department of Mechanical Engineering at Texas A&amp;M University, the National Science Foundation (NSF) BRITE Fellow program (CMMI 2227641), the NSF CSSI program (OAC 1835782), the Kansas City National Security Campus (PDRD #705288), and NSF CAREER Award (CMMI-2142460). R.S. acknowledges financial support from the NSF Graduate Research Fellowship Program.</p>
    </para>
  </section>
  <bibliography bibstyle="unsrt" citestyle="numbers" files="references" xml:id="bib">
    <title>References</title>
  </bibliography>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %\clearpage 
     %\appendix␣␣␣␣␣␣␣%%%␣starting␣appendix 
     %\section*{Appendix␣A:␣Confusion␣Matrices␣of␣Trained␣Random␣Forests} -->  <appendix inlist="toc" labels="LABEL:sec:single_shot" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Related Works on Single-Shot Inverse Design</title>
    <toctitle><tag close=" ">A</tag>Related Works on Single-Shot Inverse Design</toctitle>
    <para xml:id="A1.p1">
      <p>Figure <ref labelref="LABEL:fig:support_past_work"/> shows the schematic diagrams of three mainstream machine learning models for single-shot inverse design of metamaterials.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:support_past_work" placement="h" xml:id="A1.F7">
      <tags>
        <tag>Figure 7</tag>
        <tag role="autoref">Figure 7</tag>
        <tag role="refnum">7</tag>
        <tag role="typerefnum">Figure 7</tag>
      </tags>
      <graphics candidates="fig/support_past_work.pdf" class="ltx_centering" graphic="fig/support_past_work.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A1.F7.g1"/>
      <toccaption class="ltx_centering"><tag close=" "><!--  %****␣main.tex␣Line␣375␣**** -->7<!--  %****␣main.tex␣Line␣375␣**** 
     %****␣main.tex␣Line␣375␣**** 
     %****␣main.tex␣Line␣375␣**** 
     %****␣main.tex␣Line␣375␣**** 
     %****␣main.tex␣Line␣375␣**** --></tag><!--  %****␣main.tex␣Line␣375␣**** -->Three major machine learning models for single-shot inverse design. Note that these are only conceptual plots and the networks can be more complicated in reality. Also, due to the diversity and complexity of conditional generative model architectures, we only show the network for design generation based on commonly used models (e.g., generators in cGANs or decoders in cVAEs), while omitting networks that are necessary for training (e.g., discriminators in cGANs or encoders in cVAEs).</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 7</tag><!--  %****␣main.tex␣Line␣375␣**** 
     %****␣main.tex␣Line␣375␣**** -->Three major machine learning models for single-shot inverse design. Note that these are only conceptual plots and the networks can be more complicated in reality. Also, due to the diversity and complexity of conditional generative model architectures, we only show the network for design generation based on commonly used models (e.g., generators in cGANs or decoders in cVAEs), while omitting networks that are necessary for training (e.g., discriminators in cGANs or encoders in cVAEs).<!--  %****␣main.tex␣Line␣375␣**** 
     %****␣main.tex␣Line␣375␣**** --></caption>
    </figure>
  </appendix>
  <appendix inlist="toc" labels="LABEL:sec:app_step2" xml:id="A2">
    <tags>
      <tag>Appendix B</tag>
      <tag role="autoref">Appendix B</tag>
      <tag role="refnum">B</tag>
      <tag role="typerefnum">Appendix B</tag>
    </tags>
    <title><tag close=" ">Appendix B</tag>Explanation of Step 2 in RIGID</title>
    <toctitle><tag close=" ">B</tag>Explanation of Step 2 in RIGID</toctitle>
    <para xml:id="A2.p1">
      <p>The purpose of Step 2 is to obtain the intersection of relevant design space regions for all the ranges of <Math mode="inline" tex="s" text="s" xml:id="A2.p1.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> in a target. We are approximating this goal by simply obtaining the intersection of relevant leaves. However, some non-intersecting leaves may still have intersecting design space regions. When assigning the probability to the intersecting region of two non-intersecting leaves <Math mode="inline" tex="A" text="A" xml:id="A2.p1.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">A</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="B" text="B" xml:id="A2.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>, we need to consider the predicted probabilities at both leaves (<Math mode="inline" tex="P_{A}" text="P _ A" xml:id="A2.p1.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">P</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="P_{B}" text="P _ B" xml:id="A2.p1.m5">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">P</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">B</XMTok>
            </XMApp>
          </XMath>
        </Math>). Specifically, the assigned probability at this intersecting region should be <Math mode="inline" tex="P_{A}P_{B}" text="P _ A * P _ B" xml:id="A2.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">B</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, which can be small. Therefore, we adopt the simplification of only considering the intersection of relevant leaves and ignoring the intersecting regions associated with non-intersecting leaves. The results also demonstrate that this is a reasonable approximation.</p>
    </para>
  </appendix>
  <appendix inlist="toc" xml:id="A3">
    <tags>
      <tag>Appendix C</tag>
      <tag role="autoref">Appendix C</tag>
      <tag role="refnum">C</tag>
      <tag role="typerefnum">Appendix C</tag>
    </tags>
    <title><tag close=" ">Appendix C</tag>Computational Methods for Data Collection and Validation</title>
    <toctitle><tag close=" ">C</tag>Computational Methods for Data Collection and Validation</toctitle>
    <subsection inlist="toc" xml:id="A3.SS1">
      <tags>
        <tag>C.1</tag>
        <tag role="autoref">subsection C.1</tag>
        <tag role="refnum">C.1</tag>
        <tag role="typerefnum">§C.1</tag>
      </tags>
      <title><tag close=" ">C.1</tag>Computation of Acoustic Dispersion Relations</title>
      <para xml:id="A3.SS1.p1">
        <p>We performed Bloch-wave analysis in COMSOL Multiphysics to compute the dispersion relations of acoustic metamaterials. Poisson’s ratio of 0.49, Young’s modulus of 2.7 GPa, and density of 1170 kg/m<sup>3</sup> were set as material properties with <Math mode="inline" tex="\sim 1.5\times 10^{4}" text="absent similar-to 1.5 * 10 ^ 4" xml:id="A3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="1.5" role="NUMBER">1.5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> mesh elements per unit cell.
We used Floquet-Bloch periodic boundary conditions to obtain the first 60 eigenfrequencies along all symmetry domains of the cubic irreducible Brillouin zone (Fig. <ref labelref="LABEL:fig:acoustic"/>B) for all lattices, thus generating a dispersion relation.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS2">
      <tags>
        <tag>C.2</tag>
        <tag role="autoref">subsection C.2</tag>
        <tag role="refnum">C.2</tag>
        <tag role="typerefnum">§C.2</tag>
      </tags>
      <title><tag close=" ">C.2</tag>Computation of Optical Absorbance Spectra</title>
      <para xml:id="A3.SS2.p1">
        <p>We computed the absorbance spectra for optical metasurfaces using wave analysis inspired by Zhang et al. <cite class="ltx_citemacro_cite">[<bibref bibrefs="zhang2023high" separator="," yyseparator=","/>]</cite>. The RF Module of COMSOL Multiphysics<sup>®</sup> <cite class="ltx_citemacro_cite">[<bibref bibrefs="comsol2020" separator="," yyseparator=","/>]</cite> was used to evaluate the spectral response of concern, which is the energy absorbance <Math mode="inline" tex="A(s)" text="A * s" xml:id="A3.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMDual>
                  <XMRef idref="A3.SS2.p1.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m1.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> in the visible regime (380-700 nm). An absorbance spectrum is computed with respect to 33 wavelength components <Math mode="inline" tex="s_{k}" text="s _ k" xml:id="A3.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> that are uniformly discretized over the specified range. An incident plane wave is assumed to be given from the port, located at the top face of the analysis domain. We set the periodicity of the analysis domain as 400 nm. The periodic boundary condition on electromagnetic fields is imposed on the lateral faces of the analysis domain. A substrate made of SiO<sub>2</sub> is placed right below a given unit cell instance (the black layers in Fig. <ref labelref="LABEL:fig:optical"/>A-B). With full electric fields computed through the wave analysis, the energy absorbance at a single wavelength <Math mode="inline" tex="s" text="s" xml:id="A3.SS2.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> is quantified as <Math mode="inline" tex="A(s)=1-|S_{11}(s)|^{2}" text="A * s = 1 - (absolute-value@(S _ 11 * s)) ^ 2" xml:id="A3.SS2.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">A</XMTok>
                  <XMDual>
                    <XMRef idref="A3.SS2.p1.m5.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m5.1">s</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="A3.SS2.p1.m5.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMApp xml:id="A3.SS2.p1.m5.3">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">S</XMTok>
                            <XMTok fontsize="70%" meaning="11" role="NUMBER">11</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A3.SS2.p1.m5.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m5.2">s</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, where <Math mode="inline" tex="S_{ij}" text="S _ (i * j)" xml:id="A3.SS2.p1.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is the component of the <Math mode="inline" tex="S" text="S" xml:id="A3.SS2.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math>-parameter matrix that specifies energy transfer between ports. We use the data presented in Ref. <cite class="ltx_citemacro_cite">[<bibref bibrefs="aspnes1983dielectric" separator="," yyseparator=","/>]</cite> to set the material dispersion of the dielectric.</p>
      </para>
    </subsection>
  </appendix>
  <appendix inlist="toc" xml:id="A4">
    <tags>
      <tag>Appendix D</tag>
      <tag role="autoref">Appendix D</tag>
      <tag role="refnum">D</tag>
      <tag role="typerefnum">Appendix D</tag>
    </tags>
    <title><tag close=" ">Appendix D</tag>Test performance of forward prediction</title>
    <toctitle><tag close=" ">D</tag>Test performance of forward prediction</toctitle>
    <para xml:id="A4.p1">
      <p>Test data for all the design problems are designs <Math mode="inline" tex="\mathbf{x}" text="x" xml:id="A4.p1.m1">
          <XMath>
            <XMTok font="bold" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> (that the random forests have never seen during training) and their corresponding qualitative behaviors <Math mode="inline" tex="y\in\{0,1\}" text="y element-of set@(0, 1)" xml:id="A4.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="A4.p1.m2.1"/>
                  <XMRef idref="A4.p1.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="A4.p1.m2.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="A4.p1.m2.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> based on functional responses.</p>
    </para>
    <para xml:id="A4.p2">
      <p>In the acoustic metamaterial design problem, we have 57 test designs, yielding 5,700 test points as the entire frequency range of dispersion relations is discretized into 100 intervals for each design. In the optical metasurface design problem, we have 52 test designs, with each functional response discretized into 33 points, which yields 1,716 test points in total. In each of the synthetic design problems, we have 20 synthetic test designs, with each synthetic response discretized into 100 points. This results in 2,000 test data points in total. Confusion matrices showing test performances are in Tables <ref labelref="LABEL:tab:f1_acoustic"/>-<ref labelref="LABEL:tab:f1_test_func_sin"/>.</p>
    </para>
    <table inlist="lot" labels="LABEL:tab:f1_acoustic" placement="h" xml:id="A4.T1">
      <tags>
        <tag>Table 1</tag>
        <tag role="autoref">Table 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Table 1</tag>
      </tags>
      <toccaption><tag close=" ">1</tag>Confusion matrix on test data in the acoustic metamaterial design problem. The test F1 score is 0.82.</toccaption>
      <caption><tag close=": ">Table 1</tag>Confusion matrix on test data in the acoustic metamaterial design problem. The test F1 score is 0.82.</caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td colspan="2"/>
          <td align="center" colspan="2">Predicted</td>
        </tr>
        <tr>
          <td/>
          <td border="r"/>
          <td align="center">Yes</td>
          <td align="center">No</td>
        </tr>
        <tr>
          <td align="center" rowspan="2"><inline-block angle="90" depth="11.1pt" height="18.1pt" innerdepth="0.0pt" innerheight="6.9pt" innerwidth="29.2pt" width="6.9pt" xtranslate="-11.11pt" ytranslate="0pt">
              <p>Actual</p>
            </inline-block></td>
          <td align="center" border="r t">Yes</td>
          <td align="center" border="t">393</td>
          <td align="center" border="t">131</td>
        </tr>
        <tr>
          <td align="center" border="b r">No</td>
          <td align="center" border="b">46</td>
          <td align="center" border="b">5130</td>
        </tr>
      </tabular>
    </table>
    <table inlist="lot" labels="LABEL:tab:f1_optical" placement="h" xml:id="A4.T2">
      <tags>
        <tag>Table 2</tag>
        <tag role="autoref">Table 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Table 2</tag>
      </tags>
<!--  %****␣main.tex␣Line␣425␣**** -->      <toccaption><tag close=" ">2</tag>Confusion matrix on test data in the optical metasurface design problem. The test F1 score is 0.83.</toccaption>
      <caption><tag close=": ">Table 2</tag>Confusion matrix on test data in the optical metasurface design problem. The test F1 score is 0.83.</caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td colspan="2"/>
          <td align="center" colspan="2">Predicted</td>
        </tr>
        <tr>
          <td/>
          <td border="r"/>
          <td align="center">Yes</td>
          <td align="center">No</td>
        </tr>
        <tr>
          <td align="center" rowspan="2"><inline-block angle="90" depth="11.1pt" height="18.1pt" innerdepth="0.0pt" innerheight="6.9pt" innerwidth="29.2pt" width="6.9pt" xtranslate="-11.11pt" ytranslate="0pt">
              <p>Actual</p>
            </inline-block></td>
          <td align="center" border="r t">Yes</td>
          <td align="center" border="t">776</td>
          <td align="center" border="t">157</td>
        </tr>
        <tr>
          <td align="center" border="b r">No</td>
          <td align="center" border="b">151</td>
          <td align="center" border="b">632</td>
        </tr>
      </tabular>
    </table>
    <table inlist="lot" labels="LABEL:tab:f1_test_func_sqexp" placement="h" xml:id="A4.T3">
      <tags>
        <tag>Table 3</tag>
        <tag role="autoref">Table 3</tag>
        <tag role="refnum">3</tag>
        <tag role="typerefnum">Table 3</tag>
      </tags>
      <toccaption><tag close=" ">3</tag>Confusion matrix on test data in the SqExp problem. The test F1 score is 0.85.</toccaption>
      <caption><tag close=": ">Table 3</tag>Confusion matrix on test data in the SqExp problem. The test F1 score is 0.85.</caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td colspan="2"/>
          <td align="center" colspan="2">Predicted</td>
        </tr>
        <tr>
          <td/>
          <td border="r"/>
          <td align="center">Yes</td>
          <td align="center">No</td>
        </tr>
        <tr>
          <td align="center" rowspan="2"><inline-block angle="90" depth="11.1pt" height="18.1pt" innerdepth="0.0pt" innerheight="6.9pt" innerwidth="29.2pt" width="6.9pt" xtranslate="-11.11pt" ytranslate="0pt">
              <p>Actual</p>
            </inline-block></td>
          <td align="center" border="r t">Yes</td>
          <td align="center" border="t">229</td>
          <td align="center" border="t">68</td>
        </tr>
        <tr>
          <td align="center" border="b r">No</td>
          <td align="center" border="b">13</td>
          <td align="center" border="b">1690</td>
        </tr>
      </tabular>
    </table>
    <table inlist="lot" labels="LABEL:tab:f1_test_func_sin" placement="h" xml:id="A4.T4">
      <tags>
        <tag>Table 4</tag>
        <tag role="autoref">Table 4</tag>
        <tag role="refnum">4</tag>
        <tag role="typerefnum">Table 4</tag>
      </tags>
      <toccaption><tag close=" ">4</tag>Confusion matrix on test data in the SupSin problem. The test F1 score is 0.86.</toccaption>
      <caption><tag close=": ">Table 4</tag>Confusion matrix on test data in the SupSin problem. The test F1 score is 0.86.</caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td colspan="2"/>
          <td align="center" colspan="2">Predicted</td>
        </tr>
        <tr>
          <td/>
          <td border="r"/>
          <td align="center">Yes</td>
          <td align="center">No</td>
        </tr>
        <tr>
          <td align="center" rowspan="2"><inline-block angle="90" depth="11.1pt" height="18.1pt" innerdepth="0.0pt" innerheight="6.9pt" innerwidth="29.2pt" width="6.9pt" xtranslate="-11.11pt" ytranslate="0pt">
              <p>Actual</p>
            </inline-block></td>
          <td align="center" border="r t">Yes</td>
          <td align="center" border="t">355</td>
          <td align="center" border="t">81</td>
        </tr>
        <tr>
          <td align="center" border="b r">No</td>
          <td align="center" border="b">37</td>
          <td align="center" border="b">1527</td>
        </tr>
      </tabular>
    </table>
  </appendix>
  <appendix inlist="toc" xml:id="A5">
    <tags>
      <tag>Appendix E</tag>
      <tag role="autoref">Appendix E</tag>
      <tag role="refnum">E</tag>
      <tag role="typerefnum">Appendix E</tag>
    </tags>
    <title><tag close=" ">Appendix E</tag>Generated Designs and Corresponding Responses</title>
    <toctitle><tag close=" ">E</tag>Generated Designs and Corresponding Responses</toctitle>
    <para xml:id="A5.p1">
      <p>Figures <ref labelref="LABEL:fig:support_acoustic_1"/>-<ref labelref="LABEL:fig:support_optical_2"/> show the rest of generated designs and their corresponding responses in addition to those in Figures <ref labelref="LABEL:fig:acoustic"/>F and <ref labelref="LABEL:fig:optical"/>F.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:support_acoustic_1" xml:id="A5.F8">
      <tags>
        <tag>Figure 8</tag>
        <tag role="autoref">Figure 8</tag>
        <tag role="refnum">8</tag>
        <tag role="typerefnum">Figure 8</tag>
      </tags>
      <graphics candidates="fig/support_acoustic_1.pdf" class="ltx_centering" graphic="fig/support_acoustic_1.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A5.F8.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">8</tag>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <ERROR class="undefined">\@slowromancap</ERROR>ii@-<ERROR class="undefined">\@slowromancap</ERROR>iv@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 8</tag>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <ERROR class="undefined">\@slowromancap</ERROR>ii@-<ERROR class="undefined">\@slowromancap</ERROR>iv@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</caption>
    </figure>
    <figure inlist="lof" labels="LABEL:fig:support_acoustic_2" xml:id="A5.F9">
      <tags>
        <tag>Figure 9</tag>
        <tag role="autoref">Figure 9</tag>
        <tag role="refnum">9</tag>
        <tag role="typerefnum">Figure 9</tag>
      </tags>
      <graphics candidates="fig/support_acoustic_2.pdf" class="ltx_centering" graphic="fig/support_acoustic_2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A5.F9.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">9</tag>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <ERROR class="undefined">\@slowromancap</ERROR>v@-<ERROR class="undefined">\@slowromancap</ERROR>vii@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 9</tag>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <ERROR class="undefined">\@slowromancap</ERROR>v@-<ERROR class="undefined">\@slowromancap</ERROR>vii@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</caption>
    </figure>
    <figure inlist="lof" labels="LABEL:fig:support_acoustic_3" xml:id="A5.F10">
      <tags>
        <tag>Figure 10</tag>
        <tag role="autoref">Figure 10</tag>
        <tag role="refnum">10</tag>
        <tag role="typerefnum">Figure 10</tag>
      </tags>
      <graphics candidates="fig/support_acoustic_3.pdf" class="ltx_centering" graphic="fig/support_acoustic_3.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A5.F10.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">10</tag>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <ERROR class="undefined">\@slowromancap</ERROR>viii@-<ERROR class="undefined">\@slowromancap</ERROR>x@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 10</tag>Geometries and corresponding dispersion relations of generated acoustic metamaterial designs for bandgap targets <ERROR class="undefined">\@slowromancap</ERROR>viii@-<ERROR class="undefined">\@slowromancap</ERROR>x@ (marked as gray-shaded frequency regions). Each row shows five designs with the highest likelihood of satisfying a target.
</caption>
    </figure>
    <figure inlist="lof" labels="LABEL:fig:support_optical_1" xml:id="A5.F11">
      <tags>
        <tag>Figure 11</tag>
        <tag role="autoref">Figure 11</tag>
        <tag role="refnum">11</tag>
        <tag role="typerefnum">Figure 11</tag>
      </tags>
      <graphics candidates="fig/support_optical_1.pdf" class="ltx_centering" graphic="fig/support_optical_1.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A5.F11.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">11</tag>Designs and corresponding absorbance spectra of generated optical metasurface designs for design targets <ERROR class="undefined">\@slowromancap</ERROR>ii@-<ERROR class="undefined">\@slowromancap</ERROR>vi@ (marked as gray-shaded wavelength regions). Each row shows five designs with the highest likelihood of satisfying a target (left panel) and their absorbance spectra (right panel).
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 11</tag>Designs and corresponding absorbance spectra of generated optical metasurface designs for design targets <ERROR class="undefined">\@slowromancap</ERROR>ii@-<ERROR class="undefined">\@slowromancap</ERROR>vi@ (marked as gray-shaded wavelength regions). Each row shows five designs with the highest likelihood of satisfying a target (left panel) and their absorbance spectra (right panel).
</caption>
    </figure>
    <figure inlist="lof" labels="LABEL:fig:support_optical_2" xml:id="A5.F12">
      <tags>
        <tag>Figure 12</tag>
        <tag role="autoref">Figure 12</tag>
        <tag role="refnum">12</tag>
        <tag role="typerefnum">Figure 12</tag>
      </tags>
<!--  %****␣main.tex␣Line␣525␣**** -->      <graphics candidates="fig/support_optical_2.pdf" class="ltx_centering" graphic="fig/support_optical_2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A5.F12.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">12</tag>Designs and corresponding absorbance spectra of generated optical metasurface designs for design targets <ERROR class="undefined">\@slowromancap</ERROR>vii@-<ERROR class="undefined">\@slowromancap</ERROR>x@ (marked as gray-shaded wavelength regions). Each row shows five designs with the highest likelihood of satisfying a target (left panel) and their absorbance spectra (right panel).
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 12</tag>Designs and corresponding absorbance spectra of generated optical metasurface designs for design targets <ERROR class="undefined">\@slowromancap</ERROR>vii@-<ERROR class="undefined">\@slowromancap</ERROR>x@ (marked as gray-shaded wavelength regions). Each row shows five designs with the highest likelihood of satisfying a target (left panel) and their absorbance spectra (right panel).
</caption>
    </figure>
  </appendix>
</document>
